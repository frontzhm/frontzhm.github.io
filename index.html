<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="frontzhm, zhm, huahua, hua_hua" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="hello world">
<meta property="og:type" content="website">
<meta property="og:title" content="èŠ±èŠ±çš„åšå®¢">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="èŠ±èŠ±çš„åšå®¢">
<meta property="og:description" content="hello world">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="èŠ±èŠ±çš„åšå®¢">
<meta name="twitter:description" content="hello world">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> èŠ±èŠ±çš„åšå®¢ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?60f2cb5747a596a24f2a053f1650c30b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">èŠ±èŠ±çš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/01/todo_vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/01/todo_vue/" itemprop="url">
                  æœªå‘½å
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-04-01T14:23:39+08:00">
                2019-04-01
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/01/todo_vue/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/04/01/todo_vue/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h1><p>æ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æ¶ã€‚</p>
<p>é€’å¢ï¼švue + components + vue-router + vuex + vue-cli</p>
<h2 id="åº“å’Œæ¡†æ¶"><a href="#åº“å’Œæ¡†æ¶" class="headerlink" title="åº“å’Œæ¡†æ¶"></a>åº“å’Œæ¡†æ¶</h2><p>æˆ‘ä»¬è°ƒç”¨åº“ï¼Œå®ç°æŸä¸ªåŠŸèƒ½ã€‚æ¡†æ¶æ˜¯æ‰“å¥½æ¶å­ï¼Œæˆ‘ä»¬è£…ä¸œè¥¿ã€‚</p>
<h2 id="å®‰è£…vue"><a href="#å®‰è£…vue" class="headerlink" title="å®‰è£…vue"></a>å®‰è£…vue</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm i vue</span><br></pre></td></tr></table></figure>
<p>å¼€å§‹å¯åŠ¨</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"app"</span>&gt;&#123;&#123;msg&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="node_modules/</span>vue/dist/vue.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">let vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">    el:'#app',</span></span><br><span class="line"><span class="string">    // templateåŠ ä¸Šä¹‹åä¼šæ›¿æ¢æ‰#appè¿™ä¸ªæ ‡ç­¾</span></span><br><span class="line"><span class="string">    // template:'&lt;h1&gt;en&lt;/h1&gt;',</span></span><br><span class="line"><span class="string">    data:&#123;msg:'msg'&#125;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">vm.msg = 'msg'</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="mvvm-mvc"><a href="#mvvm-mvc" class="headerlink" title="mvvm mvc"></a>mvvm mvc</h2><p>model view Model ä¼ ç»Ÿæ‰€æœ‰é€»è¾‘åœ¨controller,éš¾ä»¥ç»´æŠ¤ã€‚ç”¨æˆ·è¾“å…¥=ã€‹æ§åˆ¶å™¨ =ã€‹æ•°æ®å˜äº†åœ¨æ¸²æŸ“åˆ°è§†å›¾ä¸Šã€‚æ•°æ®ä¼šé©±åŠ¨è§†å›¾ï¼Œç´§å¯†è”ç³»ã€‚<br>model view viewModel è§†å›¾å’Œæ•°æ®å¹¶ä¸ä¼šç´§å¯†è”ç³»ã€‚æ•°æ®å˜åŒ–é©±åŠ¨è§†å›¾ã€‚</p>
<p>å‘½ä»¤å¼ï¼šè‡ªå·±å†™forå¾ªç¯ï¼Œfor(var i=0)ã€‚å‘½ä»¤å…¶æŒ‰ç…§è‡ªå·±çš„æ–¹å¼å¾—åˆ°ç»“æœ<br>å£°æ˜å¼ï¼šforEach å£°æ˜å¼ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯å¾ªç¯ï¼Œå†…éƒ¨å¸®æˆ‘ä»¬åš</p>
<p>vueæŠŠæ•°æ®ä»£ç†ç»™äº†vmã€‚</p>
<p>åªè¦æ¨¡æ¿ä¸­ä½¿ç”¨äº†æ•°æ®ï¼Œå°±å¿…é¡»åœ¨å®ä¾‹ä¸Šå£°æ˜ã€‚ä¹Ÿå°±æ˜¯æƒ³ç”¨<code>msg</code>ï¼Œå°±å¿…é¡»åœ¨dataé‡Œæœ‰è¿™ä¸ªå±æ€§ã€‚å› ä¸ºæ•°æ®åŠ«æŒçš„åŸå› ã€‚</p>
<h2 id="observer"><a href="#observer" class="headerlink" title="observer"></a>observer</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">        name:<span class="string">'jw'</span>,</span><br><span class="line">        age:<span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// vue æ•°æ®åŠ«æŒ Object.defineProperty</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> obj === <span class="string">'object'</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">                defineReactive(obj,key,obj[key])</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// getter valueä¸èƒ½åŒæ—¶ä½¿ç”¨</span></span><br><span class="line">    <span class="comment">// getçš„returnçš„å€¼æ‰æ˜¯æœ€ç»ˆä½ å–å¾—å€¼ã€‚æ‰€ä»¥è®¾çš„å€¼æ˜¯ä¸ºè¯»å–å‡†å¤‡çš„ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">obj,key,value</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(obj,key,&#123;</span><br><span class="line">            get:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> value+<span class="number">1</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// obj.name = 1,</span></span><br><span class="line">            set:<span class="function"><span class="keyword">function</span>(<span class="params">newVal</span>)</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°äº†'</span>)</span><br><span class="line">                value = newVal</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    observer(obj)</span><br><span class="line">    obj.age = <span class="number">2</span></span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj.age)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å½“ageä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œéœ€è¦å°†ageä¹ŸåŒæ ·æ•°æ®åŠ«æŒã€‚æ‰€ä»¥éœ€è¦åœ¨defineReactiveçš„ç¬¬ä¸€è¡ŒåŠ ä¸Š<code>observer(value)</code>ã€‚è®¾ç½®å€¼çš„æ—¶å€™å¦‚æœæ˜¯å¯¹è±¡çš„è¯ï¼Œä¹Ÿéœ€è¦å°†è¿™ä¸ªå¯¹è±¡æ•°æ®åŠ«æŒã€‚æ‰€ä»¥seté‚£è¾¹ä¹Ÿéœ€è¦åŠ è¿™è¡Œã€‚</p>
<ul>
<li>å› ä¸ºæ˜¯ä¸€å¼€å§‹å°±æ•°æ®åŠ«æŒäº†ã€‚æ‰€ä»¥åæ¥å¦‚æœæ–°ç»‘å®šå±æ€§ï¼Œæ˜¯æ²¡æœ‰æ•°æ®åŠ«æŒçš„ã€‚</li>
<li><p>å½“å±æ€§å€¼æ˜¯æ•°ç»„ï¼Œæ•°ç»„å˜åŒ–çš„æ—¶å€™ï¼Œè·Ÿè¸ªä¸åˆ°å˜åŒ–ã€‚å› ä¸ºæ•°ç»„è™½ç„¶æ˜¯å¯¹è±¡ï¼Œä½†æ˜¯Object.definePropertyä¸æ”¯æŒæ•°ç»„ï¼Œæ‰€ä»¥vueæ”¹å†™äº†æ•°ç»„çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“è°ƒç”¨æ•°ç»„æ–¹æ³•çš„æ—¶å€™ï¼Œå°±è°ƒåŠ¨å˜åŠ¨äº‹ä»¶ã€‚ä½†æ˜¯ä¸èƒ½é€šè¿‡å±æ€§æˆ–è€…ç´¢å¼•æ§åˆ¶æ•°ç»„ï¼Œæ¯”å¦‚lengthã€‚</p>
</li>
<li><p>æ€»ç»“ï¼šå¯¹è±¡å¿…é¡»æ˜¯å¼€å§‹å°±æœ‰æŸå±æ€§ã€‚å¦‚æœæ˜¯æ•°ç»„ï¼Œåªèƒ½é€šè¿‡æ•°ç»„æ–¹æ³•ä¿®æ”¹æ•°ç»„ã€‚</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">        name:<span class="string">'jw'</span>,</span><br><span class="line">        age:&#123;</span><br><span class="line">            name:<span class="string">'kk'</span>,</span><br><span class="line">            age:<span class="number">3</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">defineReactive</span>(<span class="params">obj,key,value</span>)</span>&#123;</span><br><span class="line">       <span class="comment">// æ³¨æ„è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼ï¼</span></span><br><span class="line">       observer(value)</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(obj,key,&#123;</span><br><span class="line">            get:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> value</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// obj.name = 1,</span></span><br><span class="line">            set:<span class="function"><span class="keyword">function</span>(<span class="params">newVal</span>)</span>&#123;</span><br><span class="line">                <span class="comment">// æ³¨æ„è¿™é‡Œï¼ï¼ï¼ï¼ï¼ï¼ï¼</span></span><br><span class="line">                observer(newVal)</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°äº†'</span>)</span><br><span class="line">                value = newVal</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    observer(obj)</span><br><span class="line">    <span class="comment">// æœªåŠ observer(value)çš„æ—¶å€™æ˜¯æ²¡æœ‰ è·Ÿè¸ªåˆ°æ•°æ®å˜åŒ–çš„</span></span><br><span class="line">    obj.age.age = <span class="number">32</span></span><br><span class="line">    obj.age = &#123;</span><br><span class="line">        name:<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°†ageå€¼è®¾ç½®æˆä¸€ä¸ªå¯¹è±¡ä¹‹åï¼Œæ²¡æœ‰åŠ åä¸€ä¸ªobserver(value)çš„æ—¶å€™æ˜¯æ²¡æœ‰ è·Ÿè¸ªåˆ°æ•°æ®å˜åŒ–çš„</span></span><br><span class="line">    obj.age.name = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    obj.age = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">    <span class="comment">// è¿™ä¼šæ˜¯æ•æ‰ä¸åˆ°æ•°æ®å˜åŒ–çš„</span></span><br><span class="line">    obj.age.push(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// vueæŠŠæ•°ç»„ä¸Šæ‰€æœ‰çš„æ–¹æ³•é‡å†™äº†ã€‚ä½†æ˜¯å¦‚æœä½  [1,2].length--è¿™æ˜¯æ•æ‰ä¸åˆ°çš„</span></span><br><span class="line">    <span class="keyword">let</span> arr = [<span class="string">'push'</span>,<span class="string">'slice'</span>,<span class="string">'split'</span>]</span><br><span class="line">    arr.forEach(<span class="function"><span class="params">method</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> oldPush = <span class="built_in">Array</span>.property[method]</span><br><span class="line">        <span class="built_in">Array</span>.property[method] = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'æ•°æ®æ›´æ–°'</span>)</span><br><span class="line">            oldPush.call(<span class="keyword">this</span>,value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/30/todo-async-design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/03/30/todo-async-design/" itemprop="url">
                  å¼‚æ­¥ç¼–ç¨‹ç‰¹æœ‰çš„ä»£ç è®¾è®¡æ¨¡å¼
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-30T11:42:43+08:00">
                2019-03-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/30/todo-async-design/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/03/30/todo-async-design/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¼‚æ­¥ç¼–ç¨‹æœ‰å¾ˆå¤šç‰¹æœ‰çš„ä»£ç è®¾è®¡æ¨¡å¼ï¼Œä¸ºäº†å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œä½¿ç”¨åŒæ­¥æ–¹å¼å’Œå¼‚æ­¥æ–¹å¼ç¼–å†™çš„ä»£ç ä¼šæœ‰å¾ˆå¤§å·®å¼‚ã€‚ä»¥ä¸‹åˆ†åˆ«ä»‹ç»ä¸€äº›å¸¸è§çš„æ¨¡å¼ã€‚</p>
<h2 id="å‡½æ•°è¿”å›å€¼"><a href="#å‡½æ•°è¿”å›å€¼" class="headerlink" title="å‡½æ•°è¿”å›å€¼"></a>å‡½æ•°è¿”å›å€¼</h2><p>ä½¿ç”¨ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œåœ¨åŒæ­¥æ–¹å¼ä¸‹ä¸€èˆ¬æŒ‰ä»¥ä¸‹æ–¹å¼ç¼–å†™ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> output = fn1(fn2(<span class="string">'input'</span>));</span><br><span class="line"><span class="comment">// Do something.</span></span><br></pre></td></tr></table></figure>
<p>è€Œåœ¨å¼‚æ­¥æ–¹å¼ä¸‹ï¼Œç”±äºå‡½æ•°æ‰§è¡Œç»“æœä¸æ˜¯é€šè¿‡è¿”å›å€¼ï¼Œè€Œæ˜¯é€šè¿‡å›è°ƒå‡½æ•°ä¼ é€’ï¼Œå› æ­¤ä¸€èˆ¬æŒ‰ä»¥ä¸‹æ–¹å¼ç¼–å†™ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fn2(<span class="string">'input'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">output2</span>) </span>&#123;</span><br><span class="line">    fn1(output2, <span class="function"><span class="keyword">function</span> (<span class="params">output1</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Do something.</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹å¼å°±æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°å¥—ä¸€ä¸ªå›è°ƒå‡½å¤šï¼Œå¥—å¾—å¤ªå¤šäº†å¾ˆå®¹æ˜“å†™å‡º<code>&gt;</code>å½¢çŠ¶çš„ä»£ç ã€‚</p>
<p>ä¸¾ä¸ªğŸŒ°ï¼š</p>
<p>æˆ‘éœ€è¦å…ˆå¯¹ä¸€ä¸ªæ•°åŠ 10ç„¶åå†*10</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTen</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num+<span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multifyTen</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num*<span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">10</span></span><br><span class="line"><span class="keyword">let</span> result = addTen(<span class="number">10</span>)</span><br><span class="line">result = mutifyTen(result)</span><br><span class="line"><span class="comment">// ç›¸å½“äº result = mutifyTen(addTen(10))</span></span><br></pre></td></tr></table></figure>
<h2 id="éå†æ•°ç»„"><a href="#éå†æ•°ç»„" class="headerlink" title="éå†æ•°ç»„"></a>éå†æ•°ç»„</h2><p>åœ¨éå†æ•°ç»„æ—¶ï¼Œä½¿ç”¨æŸä¸ªå‡½æ•°ä¾æ¬¡å¯¹æ•°æ®æˆå‘˜åšä¸€äº›å¤„ç†ä¹Ÿæ˜¯å¸¸è§çš„éœ€æ±‚ã€‚</p>
<p>åŒæ­¥ä»£ç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> len = arr.length,</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (; i &lt; len; ++i) &#123;</span><br><span class="line">    arr[i] = doSomething(arr[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// map forEach...</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'ä»¥ä¸Šæ‰§è¡Œå®Œäº†'</span>)</span><br><span class="line"><span class="comment">// All array items have processed.</span></span><br></pre></td></tr></table></figure>
<p>å¼‚æ­¥ä»£ç ï¼šå…ˆè¯´ä¸²è¡Œçš„æƒ…å†µ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">i, len, callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; len) &#123;</span><br><span class="line">        <span class="keyword">async</span>(arr[i], <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">            arr[i] = value;</span><br><span class="line">            next(i + <span class="number">1</span>, len, callback);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        callback();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(<span class="number">0</span>, arr.length, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// All array items have processed.</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/observer-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/03/29/observer-code/" itemprop="url">
                  è§‚å¯Ÿè€…æ¨¡å¼ç®€å•ç‰ˆ
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-29T14:56:01+08:00">
                2019-03-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/29/observer-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/03/29/observer-code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h1><p>ä¸¤ä¸ªè§’è‰²ï¼šè§‚å¯Ÿè€… è¢«è§‚å¯Ÿè€…ã€‚</p>
<p>ä»£ç å®ç°çš„é€»è¾‘ï¼š</p>
<ul>
<li>è¢«è§‚å¯Ÿè€… éœ€è¦æ”¾åœ¨ è§‚å¯Ÿè€… ä¸­ã€‚</li>
<li>è¢«è§‚å¯Ÿè€… è¦æä¾›ä¸€ä¸ªæ›´æ–°ä¹Ÿå°±æ˜¯updateçš„æ–¹æ³•ã€‚</li>
<li>å½“ è¢«è§‚å¯Ÿè€… çš„æ•°æ®å‘é€å˜åŒ–æ—¶ï¼Œéœ€è¦æ‰§è¡Œ è§‚å¯Ÿè€… çš„ update æ–¹æ³•ã€‚</li>
</ul>
<p>è§‚å¯Ÿè€…æ¨¡å¼ æ˜¯æœ‰å…³ç³»çš„ã€‚åŸºäºå‘å¸ƒè®¢é˜…ã€‚</p>
<p>è¢«è§‚å¯Ÿè€…æä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯æ·»åŠ è§‚å¯Ÿè€…ï¼Œä¸€ä¸ªè‡ªå·±çŠ¶æ€æ”¹å˜<br>è§‚å¯Ÿè€…æä¾› updateçš„æ–¹æ³•ï¼Œä¾›è¢«è§‚å¯Ÿè€…çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œè°ƒç”¨ã€‚</p>
<h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>çˆ¶æ¯è§‚å¯Ÿå°å®å®ã€‚ å°å®å®å°±æ˜¯è¢«è§‚å¯Ÿè€…ã€‚ çˆ¶æ¯å°±æ˜¯è§‚å¯Ÿè€…ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// observer è¢«è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="comment">// subject è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observer</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.state = <span class="string">'ä¸å¼€å¿ƒ'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Subject</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Subject.prototype.update = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> Observer()</span><br><span class="line"><span class="keyword">let</span> s1 = <span class="keyword">new</span> Subject(<span class="string">'æˆ‘'</span>,o)</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="keyword">new</span> Subject(<span class="string">'åª³å¦‡'</span>,o)</span><br></pre></td></tr></table></figure>
<p>å†æ¥å®Œæ•´ç‰ˆ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// observer è¢«è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="comment">// subject è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observer</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.state = <span class="string">"ä¸å¼€å¿ƒ"</span>;</span><br><span class="line">  <span class="keyword">this</span>.arr = [];</span><br><span class="line">&#125;</span><br><span class="line">Observer.prototype.attach = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// subkect</span></span><br><span class="line">  <span class="keyword">this</span>.arr.push(s);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// çŠ¶æ€æ”¹å˜</span></span><br><span class="line">Observer.prototype.setState = <span class="function"><span class="keyword">function</span>(<span class="params">newState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.state = newState;</span><br><span class="line">  <span class="comment">// è®©è§‚å¯Ÿè€…éƒ½çŸ¥é“ sæŒ‡çš„å°±æ˜¯è§‚å¯Ÿè€…</span></span><br><span class="line">  <span class="keyword">this</span>.arr.forEach(<span class="function"><span class="params">s</span> =&gt;</span> s.update(<span class="keyword">this</span>.state));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Subject</span>(<span class="params">name, observer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.observer = observer;</span><br><span class="line">&#125;</span><br><span class="line">Subject.prototype.update = <span class="function"><span class="keyword">function</span>(<span class="params">newState</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name+<span class="string">'ç›‘æµ‹åˆ°äº†å®å®çš„'</span>+newState+<span class="string">'å˜åŒ–'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> Observer();</span><br><span class="line"><span class="keyword">let</span> s1 = <span class="keyword">new</span> Subject(<span class="string">"æˆ‘"</span>, o);</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="keyword">new</span> Subject(<span class="string">"åª³å¦‡"</span>, o);</span><br><span class="line">o.attach(s1);</span><br><span class="line">o.attach(s2);</span><br><span class="line">o.setState(<span class="string">'å¼€å¿ƒäº†'</span>)</span><br><span class="line">o.setState(<span class="string">'åˆä¸å¼€å¿ƒäº†'</span>)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/fetch_express/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/03/29/fetch_express/" itemprop="url">
                  fetchåœ¨postè¯·æ±‚çš„æ—¶å€™å¿…é¡»åŠ Content-Type
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-29T09:42:29+08:00">
                2019-03-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/29/fetch_express/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/03/29/fetch_express/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p>fetch é»˜è®¤çš„ Content-Type æ˜¯<code>text/plain</code>ï¼Œåœ¨ post è¯·æ±‚çš„æ—¶å€™å¿…é¡»åŠ <code>Content-Type:application/json</code>æˆ–è€…<code>Content-Type:application/x-www-form-urlencoded</code>ã€‚axios å’Œ jquery çš„ ajax é»˜è®¤æ˜¯<code>application/x-www-form-urlencoded</code>ã€‚</p>
<h2 id="æ˜¾ç¤ºæºç "><a href="#æ˜¾ç¤ºæºç " class="headerlink" title="æ˜¾ç¤ºæºç "></a>æ˜¾ç¤ºæºç </h2><h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>fetch çš„ get è¯·æ±‚åªèƒ½åœ¨ url åé¢å†™å‚æ•°ï¼Œä¸èƒ½å† body é‡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getè¯·æ±‚åé¢æ‹¼å‚æ•°</span></span><br><span class="line">fetch(<span class="string">"/api/login?e=9&amp;h=4"</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  data.json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨ req.queryæ‹¿åˆ°å¯¹è±¡&#123;e:9.h:4&#125;</span></span><br><span class="line">app.get(<span class="string">"/api/login"</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.query);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="noopener">fetch</a>çš„ post è¯·æ±‚ï¼Œå¯ä»¥åƒ get é‚£æ ·ä¼ å‚æ•°ï¼Œä½†æ˜¯å¤šæ•°æ”¾åˆ° body é‡Œã€‚<br>body çš„ç±»å‹ä¸èƒ½æ˜¯å¯¹è±¡ï¼Œå¯ä»¥æ˜¯<code>ArrayBuffer ArrayBufferView (Uint8Arrayç­‰) Blob/File string URLSearchParams FormData</code>ã€‚</p>
<p>urlencodedå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯<code>d=9&amp;h=9</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">"/api/login"</span>, &#123;</span><br><span class="line"><span class="comment">//   headers: new Headers(&#123; "Content-Type": "application/json" &#125;),</span></span><br><span class="line">  headers: <span class="keyword">new</span> Headers(&#123; <span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span> &#125;),</span><br><span class="line">  body: <span class="string">`e=9&amp;h=4`</span>,</span><br><span class="line">  method: <span class="string">"POST"</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  data.json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨ req.bodyæ‹¿åˆ°å¯¹è±¡&#123;e:9.h:4&#125;</span></span><br><span class="line">app.use(express.urlencoded())</span><br><span class="line">app.post(<span class="string">"/api/login"</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>jsonå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯<code>{e:9,h:4}</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">"/api/login"</span>, &#123;</span><br><span class="line">  headers: <span class="keyword">new</span> Headers(&#123; <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span> &#125;),</span><br><span class="line">  body: <span class="built_in">JSON</span>.stringfy(&#123;<span class="attr">e</span>:<span class="number">9</span>,<span class="attr">h</span>:<span class="number">4</span>&#125;),</span><br><span class="line">  method: <span class="string">"POST"</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  data.json();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨ req.bodyæ‹¿åˆ°å¯¹è±¡&#123;e:9.h:4&#125;</span></span><br><span class="line">app.use(express.json())</span><br><span class="line">app.post(<span class="string">"/api/login"</span>, (req, res, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(req.body);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å‚è€ƒ <a href="http://qingbob.com/problems-caused-by-fetch-post/" target="_blank" rel="noopener">ä½¿ç”¨ fetch æ¥å£çš„æ—¶å€™ï¼Œè®°å¾—æŒ‡å®š Content-Type</a><br>å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="noopener">mdnçš„ fetch </a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/usr-of-linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/03/28/usr-of-linux/" itemprop="url">
                  linuxçš„ç›®å½•ç»“æ„
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-28T14:54:13+08:00">
                2019-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ç³»ç»Ÿ/" itemprop="url" rel="index">
                    <span itemprop="name">ç³»ç»Ÿ</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/28/usr-of-linux/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/03/28/usr-of-linux/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><ul>
<li>/usr åªä¸“é—¨å­˜æ”¾å„ç§ç¨‹åºå’Œæ•°æ®</li>
<li>/varä¸­åŒ…æ‹¬äº†ä¸€äº›æ•°æ®æ–‡ä»¶ï¼Œå¦‚ç³»ç»Ÿæ—¥å¿—ç­‰ã€‚/varçš„å­˜æ”¾ä½¿å¾—/usrè¢«åªè¯»æŒ‚è½½æˆä¸ºå¯èƒ½ã€‚</li>
<li>/usr/local<br>æ–°è£…çš„ç³»ç»Ÿä¸­è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ç©ºçš„ï¼Œå¯ä»¥ç”¨äºå­˜æ”¾ä¸ªäººå®‰è£…çš„è½¯ä»¶ã€‚å®‰è£…äº†æœ¬åœ°è½¯ä»¶çš„/usr/localé‡Œçš„ç›®å½•ç»“æ„ä¸/usrç›¸ä¼¼</li>
</ul>
<h2 id="è¯¯ä¼š"><a href="#è¯¯ä¼š" class="headerlink" title="è¯¯ä¼š"></a>è¯¯ä¼š</h2><p>è¯´èµ·æ¥ï¼Œæˆ‘ä¹Ÿä»¥ä¸º<code>/usr</code>å°±æ˜¯<code>user</code>çš„æ„æ€ï¼Œç„¶åå°±è§‰å¾—<code>/home/xx</code>å¥½å¥‡æ€ªã€‚<br>å¥½å¥‡å¿ƒçš„è°·æ­Œäº†ä¸‹ã€‚<code>usr</code>æ˜¯<code>unix system resources</code>ã€‚<br>æ‰€ä»¥ï¼Œç”¨å¤„ä¸æ˜¯æŸä¸ªç”¨æˆ·ã€‚<br>ç°ä»£çš„ /usr åªä¸“é—¨å­˜æ”¾å„ç§ç¨‹åºå’Œæ•°æ®ã€‚<code>/usr</code> æ˜¯ç³»ç»Ÿæ ¸å¿ƒæ‰€åœ¨ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„å…±äº«æ–‡ä»¶ã€‚å®ƒæ˜¯ unix ç³»ç»Ÿä¸­æœ€é‡è¦çš„ç›®å½•ä¹‹ä¸€ï¼Œæ¶µç›–äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå„ç§æ–‡æ¡£ï¼Œå„ç§å¤´æ–‡ä»¶ï¼Œè¿˜æœ‰å„ç§åº“æ–‡ä»¶ï¼›è¿˜æœ‰è¯¸å¤šç¨‹åºï¼Œä¾‹å¦‚ <code>ftpï¼Œtelnet</code> ç­‰ç­‰ã€‚</p>
<h2 id="æ ¹æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ ¹æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ ¹æ–‡ä»¶ç³»ç»Ÿ"></a>æ ¹æ–‡ä»¶ç³»ç»Ÿ</h2><p>/bin<br>å…¶ä¸­binæ˜¯binaryçš„ç¼©å†™ï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šå¸¸ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸€äº›å¸¸ç”¨çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚cpã€lsç­‰ä¿å­˜åœ¨è¯¥ç›®å½•ä¸­ã€‚è¿™ä¸€ç›®å½•ä¸­å­˜æ”¾äº†ä¾›æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨çš„å®ŒæˆåŸºæœ¬ç»´æŠ¤ä»»åŠ¡çš„å‘½ä»¤ã€‚<br>/boot<br>è¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨Linuxæ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ã€‚å¦‚æ“ä½œç³»ç»Ÿå†…æ ¸ã€å¼•å¯¼ç¨‹åºGrubç­‰ã€‚<br>/dev<br>åœ¨æ­¤ç›®å½•ä¸­åŒ…å«æ‰€æœ‰çš„ç³»ç»Ÿè®¾å¤‡æ–‡ä»¶ã€‚ä»æ­¤ç›®å½•å¯ä»¥è®¿é—®å„ç§ç³»ç»Ÿè®¾å¤‡ã€‚å¦‚CD-ROMï¼Œç£ç›˜é©±åŠ¨å™¨ï¼Œè°ƒåˆ¶è§£è°ƒå™¨å’Œå†…å­˜ç­‰ã€‚åœ¨è¯¥ç›®å½•ä¸­è¿˜åŒ…å«æœ‰å„ç§å®ç”¨åŠŸèƒ½ï¼Œå¦‚ç”¨äºåˆ›å»ºè®¾å¤‡æ–‡ä»¶çš„MAKEDEVã€‚<br>/etc<br>è¯¥ç›®å½•ä¸­åŒ…å«ç³»ç»Ÿå’Œåº”ç”¨è½¯ä»¶çš„é…ç½®æ–‡ä»¶ã€‚<br>/etc/passwd<br>è¯¥ç›®å½•ä¸­åŒ…å«äº†ç³»ç»Ÿä¸­çš„ç”¨æˆ·æè¿°ä¿¡æ¯ï¼Œæ¯è¡Œè®°å½•ä¸€ä¸ªç”¨æˆ·çš„ä¿¡æ¯ã€‚<br>/home<br>å­˜å‚¨æ™®é€šç”¨æˆ·çš„ä¸ªäººæ–‡ä»¶ã€‚æ¯ä¸ªç”¨æˆ·çš„ä¸»ç›®å½•å‡åœ¨/homeä¸‹ä»¥è‡ªå·±çš„ç”¨æˆ·åå‘½åã€‚<br>/lib<br>è¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„å…±äº«é“¾æ¥åº“å’Œå†…æ ¸æ¨¡å—ã€‚å…±äº«é“¾æ¥åº“åœ¨åŠŸèƒ½ä¸Šç±»ä¼¼äºWindowsé‡Œçš„.dllæ–‡ä»¶ã€‚<br>/lib64<br>64ä½ç³»ç»Ÿæœ‰è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œ64ä½ç¨‹åºçš„åº“ã€‚<br>/lost+found<br>è¿™å¹¶ä¸æ˜¯Linuxç›®å½•ç»“æ„çš„ç»„æˆéƒ¨åˆ†ï¼Œè€Œæ˜¯ext3æ–‡ä»¶ç³»ç»Ÿç”¨äºä¿å­˜ä¸¢å¤±æ–‡ä»¶çš„åœ°æ–¹ã€‚ä¸æ°å½“çš„å…³æœºæ“ä½œå’Œç£ç›˜é”™è¯¯å‡ä¼šå¯¼è‡´æ–‡ä»¶ä¸¢å¤±ï¼Œè¿™æ„å‘³ç€è¿™äº›è¢«æ ‡æ³¨ä¸ºâ€œåœ¨ä½¿ç”¨â€ï¼Œä½†å´å¹¶æœªåˆ—äºç£ç›˜ä¸Šçš„æ•°æ®ç»“æ„ä¸Šã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¼•å¯¼è¿›ç¨‹ä¼šè¿è¡Œfsckç¨‹åºï¼Œè¯¥ç¨‹åºèƒ½å‘ç°è¿™äº›æ–‡ä»¶ã€‚é™¤äº†â€œ/â€åˆ†åŒºä¸Šçš„è¿™ä¸ªç›®å½•å¤–ï¼Œåœ¨æ¯ä¸ªåˆ†åŒºä¸Šå‡æœ‰ä¸€ä¸ªlost+foundç›®å½•ã€‚<br>/media<br>å¯ç§»åŠ¨è®¾å¤‡çš„æŒ‚è½½ç‚¹ï¼Œå½“å‰çš„æ“ä½œç³»ç»Ÿé€šå¸¸ä¼šæŠŠUç›˜ç­‰è®¾å¤‡è‡ªåŠ¨æŒ‚è½½åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹ã€‚<br>/mnt<br>ä¸´æ—¶ç”¨äºæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿçš„åœ°æ–¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªç›®å½•æ˜¯ç©ºçš„ï¼Œè€Œåœ¨æˆ‘ä»¬å°†è¦æŒ‚è½½åˆ†åŒºæ—¶åœ¨è¿™ä¸ªç›®å½•ä¸‹å»ºç«‹ç›®å½•ï¼Œå†å°†æˆ‘ä»¬å°†è¦è®¿é—®çš„è®¾å¤‡æŒ‚è½½åœ¨è¿™ä¸ªç›®å½•ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯è®¿é—®æ–‡ä»¶äº†ã€‚ï¼ˆæ³¨æ„åœ¨GNOMEä¸­ï¼Œåªæœ‰æŒ‚è½½åˆ°/mediaçš„æ–‡ä»¶å¤¹æ‰ä¼šæ˜¾ç¤ºåœ¨â€œè®¡ç®—æœºâ€ä¸­ï¼ŒæŒ‚è½½åˆ°/mntä¸ä¼šåšä¸ºç‰¹æ®Šè®¾å¤‡æ˜¾ç¤ºï¼Œè¯¦è§è‡ªåŠ¨æŒ‚è½½åˆ†åŒºï¼‰<br>/opt<br>å¤šæ•°ç¬¬ä¸‰æ–¹è½¯ä»¶é»˜è®¤å®‰è£…åˆ°æ­¤ä½ç½®ï¼Œå¦‚Adobe Readerã€google-earthç­‰ã€‚å¹¶ä¸æ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½ä¼šåˆ›å»ºè¿™ä¸ªç›®å½•ã€‚<br>/proc<br>å®ƒæ˜¯å­˜åœ¨äºå†…å­˜ä¸­çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚é‡Œé¢ä¿å­˜äº†å†…æ ¸å’Œè¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ã€‚å¤šä¸ºæ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥æŸ¥çœ‹ã€‚å¦‚/proc/cpuinfoä¿å­˜äº†æœ‰å…³CPUçš„ä¿¡æ¯ã€‚<br>/root<br>è¿™æ˜¯æ ¹ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ä¸ä¿ç•™ç»™ä¸ªäººç”¨æˆ·çš„/homeä¸‹çš„ç›®å½•å¾ˆç›¸ä¼¼ï¼Œè¯¥ç›®å½•ä¸­è¿˜åŒ…å«ä»…ä¸æ ¹ç”¨æˆ·æœ‰å…³çš„æ¡ç›®ã€‚<br>/sbin<br>ä¾›è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡Œé¢å¤šæ˜¯ç³»ç»Ÿç®¡ç†å‘½ä»¤ï¼Œå¦‚fsck, reboot, shutdown, ifconfigç­‰ã€‚<br>/tmp<br>è¯¥ç›®å½•ç”¨ä»¥ä¿å­˜ä¸´æ—¶æ–‡ä»¶ã€‚è¯¥ç›®å½•å…·æœ‰Stickyç‰¹æ®Šæƒé™ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥åœ¨è¿™ä¸ªç›®å½•ä¸­åˆ›å»ºã€ç¼–è¾‘æ–‡ä»¶ã€‚ä½†åªæœ‰æ–‡ä»¶æ‹¥æœ‰è€…æ‰èƒ½åˆ é™¤æ–‡ä»¶ã€‚ä¸ºäº†åŠ å¿«ä¸´æ—¶æ–‡ä»¶çš„è®¿é—®é€Ÿåº¦ï¼Œæœ‰çš„å®ç°æŠŠ/tmpæ”¾åœ¨å†…å­˜ä¸­ã€‚<br>/usr<br>é™æ€çš„ç”¨æˆ·çº§åº”ç”¨ç¨‹åºç­‰ï¼Œè§ä¸‹ã€‚<br>/var<br>åŠ¨æ€çš„ç¨‹åºæ•°æ®ç­‰ï¼Œè§ä¸‹æ–‡ã€‚<br>/usrç›®å½•ç»“æ„<br>/usré€šå¸¸æ˜¯ä¸€ä¸ªåºå¤§çš„æ–‡ä»¶å¤¹ï¼Œå…¶ä¸‹çš„ç›®å½•ç»“æ„ä¸æ ¹ç›®å½•ç›¸ä¼¼ï¼Œä½†æ ¹ç›®å½•ä¸­çš„æ–‡ä»¶å¤šæ˜¯ç³»ç»Ÿçº§çš„æ–‡ä»¶ï¼Œè€Œ/usrä¸­æ˜¯ç”¨æˆ·çº§çš„æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸å…·ä½“çš„ç³»ç»Ÿæ— å…³ã€‚</p>
<h2 id="usr"><a href="#usr" class="headerlink" title="usr"></a>usr</h2><p>åº”æ³¨æ„ï¼Œç¨‹åºçš„é…ç½®æ–‡ä»¶ã€åŠ¨æ€çš„æ•°æ®æ–‡ä»¶ç­‰éƒ½ä¸ä¼šå­˜æ”¾åˆ°/usrï¼Œæ‰€ä»¥é™¤äº†å®‰è£…ã€å¸è½½è½¯ä»¶å¤–ï¼Œä¸€èˆ¬æ— éœ€ä¿®æ”¹/usrä¸­çš„å†…å®¹ã€‚è¯´åœ¨ç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶ï¼Œ/usrç”šè‡³å¯ä»¥è¢«åªè¯»æŒ‚è½½ã€‚ç”±äºè¿™ä¸€ç‰¹æ€§ï¼Œ/usrå¸¸è¢«åˆ’åˆ†åœ¨å•ç‹¬çš„åˆ†åŒºï¼Œç”šè‡³æœ‰æ—¶å¤šå°è®¡ç®—æœºå¯ä»¥å…±äº«ä¸€ä¸ª/usrã€‚</p>
<p>/usr/bin<br>å¤šæ•°æ—¥å¸¸åº”ç”¨ç¨‹åºå­˜æ”¾çš„ä½ç½®ã€‚å¦‚æœ/usrè¢«æ”¾åœ¨å•ç‹¬çš„åˆ†åŒºä¸­ï¼ŒLinuxçš„å•ç”¨æˆ·æ¨¡å¼ä¸èƒ½è®¿é—®/usr/binï¼Œæ‰€ä»¥å¯¹ç³»ç»Ÿè‡³å…³é‡è¦çš„ç¨‹åºä¸åº”æ”¾åœ¨æ­¤æ–‡ä»¶å¤¹ä¸­ã€‚<br>/usr/include<br>å­˜æ”¾C/C++å¤´æ–‡ä»¶çš„ç›®å½•<br>/usr/lib<br>ç³»ç»Ÿçš„åº“æ–‡ä»¶<br>/usr/local<br>æ–°è£…çš„ç³»ç»Ÿä¸­è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ç©ºçš„ï¼Œå¯ä»¥ç”¨äºå­˜æ”¾ä¸ªäººå®‰è£…çš„è½¯ä»¶ã€‚å®‰è£…äº†æœ¬åœ°è½¯ä»¶çš„/usr/localé‡Œçš„ç›®å½•ç»“æ„ä¸/usrç›¸ä¼¼<br>/usr/sbin<br>åœ¨å•ç”¨æˆ·æ¨¡å¼ä¸­ä¸ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºï¼Œå¦‚apache2ç­‰ã€‚<br>/usr/share<br>ä¸æ¶æ„æ— å…³çš„æ•°æ®ã€‚å¤šæ•°è½¯ä»¶å®‰è£…åœ¨æ­¤ã€‚<br>/usr/X11R6<br>è¯¥ç›®å½•ç”¨äºä¿å­˜è¿è¡ŒX-Windowæ‰€éœ€çš„æ‰€æœ‰æ–‡ä»¶ã€‚è¯¥ç›®å½•ä¸­è¿˜åŒ…å«ç”¨äºè¿è¡ŒGUIè¦çš„é…ç½®æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚<br>/usr/src<br>æºä»£ç </p>
<h2 id="var"><a href="#var" class="headerlink" title="var"></a>var</h2><p>/varä¸­åŒ…æ‹¬äº†ä¸€äº›æ•°æ®æ–‡ä»¶ï¼Œå¦‚ç³»ç»Ÿæ—¥å¿—ç­‰ã€‚/varçš„å­˜æ”¾ä½¿å¾—/usrè¢«åªè¯»æŒ‚è½½æˆä¸ºå¯èƒ½ã€‚</p>
<p>/var/cache<br>åº”ç”¨ç¨‹åºçš„ç¼“å­˜æ–‡ä»¶<br>/var/lib<br>åº”ç”¨ç¨‹åºçš„ä¿¡æ¯ã€æ•°æ®ã€‚å¦‚æ•°æ®åº“çš„æ•°æ®ç­‰éƒ½å­˜æ”¾åœ¨æ­¤æ–‡ä»¶å¤¹ã€‚<br>/var/local<br>/usr/localä¸­ç¨‹åºçš„ä¿¡æ¯ã€æ•°æ®<br>/var/lock<br>é”æ–‡ä»¶<br>/var/log<br>æ—¥å¿—æ–‡ä»¶<br>/var/opt<br>/optä¸­ç¨‹åºçš„ä¿¡æ¯ã€æ•°æ®<br>/var/run<br>æ­£åœ¨æ‰§è¡Œç€çš„ç¨‹åºçš„ä¿¡æ¯ï¼Œå¦‚PIDæ–‡ä»¶åº”å­˜æ”¾äºæ­¤<br>/var/spool<br>å­˜æ”¾ç¨‹åºçš„å‡è„±æœºæ•°æ®ï¼ˆå³spool dataï¼‰<br>/var/tmp<br>ä¸´æ—¶æ–‡ä»¶</p>
<blockquote>
<p>å‚è€ƒ<a href="https://blog.csdn.net/zsg88/article/details/75209319" target="_blank" rel="noopener">linuxä¸­çš„/usr,/var,/optç›®å½•è¯¦è§£</a><br>å‚è€ƒ<a href="http://linux-wiki.cn/wiki/zh-hans/Linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" target="_blank" rel="noopener">Linuxç›®å½•ç»“æ„</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/set-node-server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/03/28/set-node-server/" itemprop="url">
                  æœåŠ¡å™¨é…ç½®nodeç¯å¢ƒå’Œé¡¹ç›®
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-03-28T13:38:29+08:00">
                2019-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/28/set-node-server/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/03/28/set-node-server/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="é…ç½®nodeç¯å¢ƒ"><a href="#é…ç½®nodeç¯å¢ƒ" class="headerlink" title="é…ç½®nodeç¯å¢ƒ"></a>é…ç½®nodeç¯å¢ƒ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> sshç™»å½•æœåŠ¡å™¨</span><br><span class="line">ssh m@124.4.5.4</span><br><span class="line">è¾“å…¥å¯†ç </span><br><span class="line">cd /home/zhm/software</span><br><span class="line"><span class="meta">#</span> ä¸‹è½½  [wgetå‘½ä»¤æ˜¯ä¸‹è½½](http://www.cnblogs.com/peida/archive/2013/03/18/2965369.html)</span><br><span class="line"><span class="meta">#</span> ä¸è¦è¿™ä¸ªæºç  ç¼–è¯‘å¤ªè´¹åŠ² wget https://nodejs.org/dist/v10.15.3/node-v10.15.3.tar.gz</span><br><span class="line">wget https://nodejs.org/dist/v10.15.3/node-v10.15.3-linux-x64.tar.xz</span><br><span class="line"><span class="meta">#</span> è§£å‹ node-v10.15.3.tar.gzè¢«è§£å‹åˆ°å½“å‰ç›®å½•ï¼Œæ–‡ä»¶å¤¹node-v10.15.3</span><br><span class="line">xz -d node-v10.15.3-linux-x64.tar.xz</span><br><span class="line"><span class="meta">#</span> å†æ¬¡è§£å‹</span><br><span class="line">tar -xvf node-v10.15.3-linux-x64.tar</span><br><span class="line"><span class="meta">#</span> æ‹¿åˆ°ç›®å½•</span><br><span class="line">cd node-v10.15.3-linux-x64</span><br><span class="line"><span class="meta">#</span> è¿™ä¸ªè·¯å¾„ç­‰ä¸‹è¦ç”¨ï¼Œå‡è®¾è¿™ä¸ªè·¯å¾„æ˜¯AAA  å…¶å®å¯ä»¥çœ‹ä¸‹ ls binå°±å¯ä»¥çœ‹åˆ° `npm node npx`è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆèƒ½ç”¨å‘½ä»¤çš„åŸå› </span><br><span class="line">pwd</span><br><span class="line"><span class="meta">#</span> npm nodeè®¾ç½®åˆ°å…¨å±€ ä¸¤ç§æ–¹å¼ </span><br><span class="line"><span class="meta">#</span> è½¯é“¾æ¥</span><br><span class="line"><span class="meta">#</span># å…ˆè·å–PATHå˜é‡ ä¼šæ‰“å°ç±»ä¼¼äº /usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin ä¸€èˆ¬ä¼šæœ‰/usr/local/binï¼Œå‡è®¾è¿™ä¸ªè·¯å¾„æ˜¯BBBã€‚</span><br><span class="line">echo $PATH</span><br><span class="line"><span class="meta">#</span># æˆ‘ä»¬å°†nodeå’Œnpmé“¾æ¥åˆ°PATHä¸‹ï¼Œè¿™æ ·å°±å¯ä»¥æ‰§è¡Œ  å…¶å®å°±æ˜¯å»ºç«‹è½¯é“¾æ¥ã€‚</span><br><span class="line">ln -s AAA/bin/node BBB/node</span><br><span class="line">ln -s AAA/bin/npm BBB/npm</span><br><span class="line">ln -s AAA/bin/npx BBB/npx</span><br><span class="line"><span class="meta">#</span> æ°¸ä¹…è®¾ç½®ï¼ˆæ²¡è¯•äº†ï¼‰</span><br><span class="line"><span class="meta">#</span> é¦–å…ˆåœ¨ root ç›®å½•ä¸‹æ‰¾åˆ° .bash_profile æ–‡ä»¶ï¼Œç¼–è¾‘ï¼Œvi ~/.bash_profile æ‰¾åˆ° PATH=$PATH:$HOME/binï¼Œåœ¨åé¢æ·»åŠ è·¯å¾„ä¸ºï¼šPATH=$PATH:$HOME/bin:/usr/local/nodejs/binä¿å­˜ä¿®æ”¹ï¼Œç„¶åé‡è½½ä¸€ä¸‹ï¼Œsource ~/.bash_profile</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> åœ¨ä»»æ„ç›®å½•ä¸‹</span><br><span class="line">npm -v</span><br><span class="line">node -v</span><br><span class="line">npx -v</span><br></pre></td></tr></table></figure>
<h2 id="ç‰¹åˆ«ä¹‹å¤„"><a href="#ç‰¹åˆ«ä¹‹å¤„" class="headerlink" title="ç‰¹åˆ«ä¹‹å¤„"></a>ç‰¹åˆ«ä¹‹å¤„</h2><p>åœ¨Linuxç³»ç»Ÿä¸‹ï¼Œä½¿ç”¨NodeJSç›‘å¬80æˆ–443ç«¯å£æä¾›HTTP(S)æœåŠ¡æ—¶éœ€è¦rootæƒé™ã€‚<br>æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åšåˆ°ã€‚</p>
<p>ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨sudoå‘½ä»¤è¿è¡ŒNodeJSã€‚ä¾‹å¦‚é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œçš„server.jsä¸­æœ‰æƒé™ä½¿ç”¨80å’Œ443ç«¯å£ã€‚ä¸€èˆ¬æ¨èè¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¿è¯ä»…ä¸ºæœ‰éœ€è¦çš„JSè„šæœ¬æä¾›rootæƒé™ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo node server.js</span><br></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨chmod +så‘½ä»¤è®©NodeJSæ€»æ˜¯ä»¥rootæƒé™è¿è¡Œï¼Œå…·ä½“åšæ³•å¦‚ä¸‹ã€‚å› ä¸ºè¿™ç§æ–¹å¼è®©ä»»ä½•JSè„šæœ¬éƒ½æœ‰äº†rootæƒé™ï¼Œä¸å¤ªå®‰å…¨ï¼Œå› æ­¤åœ¨éœ€è¦å¾ˆè€ƒè™‘å®‰å…¨çš„ç³»ç»Ÿä¸‹ä¸æ¨èä½¿ç”¨ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root /usr/local/bin/node</span><br><span class="line">sudo chmod +s /usr/local/bin/node</span><br></pre></td></tr></table></figure>
<h2 id="é¡¹ç›®è¿è¡Œ"><a href="#é¡¹ç›®è¿è¡Œ" class="headerlink" title="é¡¹ç›®è¿è¡Œ"></a>é¡¹ç›®è¿è¡Œ</h2><p>å°†é¡¹ç›®æ”¾è¿›æ¥ã€‚ <code>nohup</code>åŠ åœ¨ä¸€ä¸ªå‘½ä»¤çš„æœ€å‰é¢ï¼Œè¡¨ç¤ºä¸æŒ‚æ–­çš„è¿è¡Œå‘½ä»¤ã€‚<code>&amp;</code>åŠ è½½ä¸€ä¸ªå‘½ä»¤çš„æœ€åé¢ï¼Œè¡¨ç¤ºè¿™ä¸ªå‘½ä»¤æ”¾åœ¨åå°æ‰§è¡Œã€‚æŸ¥çœ‹è¿è¡Œçš„å‘½ä»¤ï¼Œæœ‰ä¸¤ä¸ªå‘½ä»¤å¯ä»¥æ¥æŸ¥çœ‹ï¼Œps å’Œ jobsã€‚åŒºåˆ«åœ¨äº jobs åªèƒ½æŸ¥çœ‹å½“å‰ç»ˆç«¯åå°æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ¢äº†ç»ˆç«¯å°±çœ‹ä¸è§äº†ã€‚è€Œpså‘½ä»¤é€‚ç”¨äºæŸ¥çœ‹ç¬æ—¶è¿›ç¨‹çš„åŠ¨æ€ï¼Œå¯ä»¥çœ‹åˆ°åˆ«çš„ç»ˆç«¯çš„ä»»åŠ¡ã€‚æ€æ‰ç¨‹åº <code>kill pidå·</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> è®©ç¨‹åºåœ¨åå°è¿è¡Œ</span><br><span class="line">nohup node app.js &amp;</span><br><span class="line"><span class="meta">#</span> çœ‹ä¸‹ä»»åŠ¡å· nodeçš„é‚£ä¸ª</span><br><span class="line">ps</span><br><span class="line"><span class="meta">#</span> å¦‚æœéœ€è¦ç»ˆæ­¢çš„è¯</span><br><span class="line">kill 21455</span><br></pre></td></tr></table></figure>
<h2 id="å…¬é’¥"><a href="#å…¬é’¥" class="headerlink" title="å…¬é’¥"></a>å…¬é’¥</h2><p>æ£€æŸ¥æœ‰æ²¡æœ‰å®‰è£…sshï¼š<code>ssh -v</code>ï¼Œå®‰è£…çš„å‘½ä»¤<code>ssh-keygen -t rsa -C &quot;youremail@example.com&quot;</code>ä¸€è·¯å›è½¦ç¡®å®šä¸‹å°±å®‰è£…å¥½äº†ã€‚ç”Ÿæˆåœ¨å½“å‰ç”¨æˆ·åä¸‹ä¼šæœ‰ä¸€ä¸ª.shæ–‡ä»¶ã€‚<br>æ£€æŸ¥æœ‰æ²¡æœ‰å…±é’¥ï¼š <code>ls -a ~/.ssh</code><br>ç”Ÿæˆå…¬é’¥ï¼š<code>ssh-keygen</code>å®ƒå…ˆè¦æ±‚ä½ ç¡®è®¤ä¿å­˜å…¬é’¥çš„ä½ç½®ï¼ˆ.ssh/id_rsaï¼‰,ç„¶åå®ƒä¼šè®©ä½ é‡å¤ä¸€ä¸ªå¯†ç ä¸¤æ¬¡ï¼Œå¦‚æœä¸æƒ³åœ¨ä½¿ç”¨å…¬é’¥çš„æ—¶å€™è¾“å…¥å¯†ç ï¼Œå¯ä»¥ç•™ç©ºã€‚<br>æ‰“å°å…¬é’¥å¤åˆ¶å‘ç»™ç®¡ç†äººå‘˜ï¼š<code>cat ~/.ssh/id_rsa.pub</code></p>
<h2 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure>
<h2 id="è¿œç¨‹ç¼–è¾‘æ–‡ä»¶"><a href="#è¿œç¨‹ç¼–è¾‘æ–‡ä»¶" class="headerlink" title="è¿œç¨‹ç¼–è¾‘æ–‡ä»¶"></a>è¿œç¨‹ç¼–è¾‘æ–‡ä»¶</h2><p>vscodeå®‰è£…æ’ä»¶sftpï¼›ä½œè€…æ˜¯liximomoã€‚<br> .vscode åœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªsftp.jsonã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"host"</span>: <span class="string">"æœåŠ¡å™¨ipåœ°å€"</span>,</span><br><span class="line">    <span class="string">"port"</span>: <span class="number">22</span>,</span><br><span class="line">    <span class="string">"username"</span>: <span class="string">"ç™»å½•å"</span>,</span><br><span class="line">    <span class="string">"password"</span>: <span class="string">"ç™»å½•å¯†ç "</span>,</span><br><span class="line">    <span class="string">"protocol"</span>: <span class="string">"sftp"</span>,</span><br><span class="line">    <span class="string">"agent"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"privateKeyPath"</span>: <span class="string">"å­˜æ”¾åœ¨æœ¬åœ°çš„å·²é…ç½®å¥½çš„ç”¨äºç™»å½•å·¥ä½œç«™çš„å¯†é’¥æ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥æ˜¯ppkæ–‡ä»¶"</span>,</span><br><span class="line">    <span class="string">"passphrase"</span>: <span class="string">""</span>,</span><br><span class="line">    <span class="string">"passive"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">"interactiveAuth"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"remotePath"</span>: <span class="string">"å·¥ä½œç«™ä¸Šä¸æœ¬åœ°å·¥ç¨‹åŒæ­¥çš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œéœ€è¦å’Œæœ¬åœ°å·¥ç¨‹æ–‡ä»¶æ ¹ç›®å½•åŒåï¼Œä¸”åœ¨ä½¿ç”¨sftpä¸Šä¼ æ–‡ä»¶ä¹‹å‰è¦æ‰‹åŠ¨åœ¨å·¥ä½œç«™ä¸Šmkdirç”Ÿæˆè¿™ä¸ªæ ¹ç›®å½•"</span>,</span><br><span class="line">    <span class="string">"uploadOnSave"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"syncMode"</span>: <span class="string">"update"</span>,</span><br><span class="line">    <span class="string">"ignore"</span>: [</span><br><span class="line">        <span class="string">"**/.vscode/**"</span>,</span><br><span class="line">        <span class="string">"**/.git/**"</span>,</span><br><span class="line">        <span class="string">"**/.DS_Store"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"watcher"</span>: &#123;</span><br><span class="line">        <span class="string">"files"</span>: <span class="string">"glob"</span>,</span><br><span class="line">        <span class="string">"autoUpload"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"autoDelete"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="vimç¼–è¾‘å™¨"><a href="#vimç¼–è¾‘å™¨" class="headerlink" title="vimç¼–è¾‘å™¨"></a>vimç¼–è¾‘å™¨</h2><p>vimæ˜¯ä»viå‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim xx.html</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥æ’å…¥æ¨¡å¼ï¼š</p>
<p>i: æ’å…¥å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦</p>
<p>I: æ’å…¥è¡Œé¦–</p>
<p>a: æ’å…¥å…‰æ ‡åä¸€ä¸ªå­—ç¬¦</p>
<p>A: æ’å…¥è¡Œæœª</p>
<p>o: å‘ä¸‹æ–°å¼€ä¸€è¡Œ,æ’å…¥è¡Œé¦–</p>
<p>O: å‘ä¸Šæ–°å¼€ä¸€è¡Œ,æ’å…¥è¡Œé¦–<br>è¿›å…¥å‘½ä»¤æ¨¡å¼ï¼š</p>
<p>ESC:ä»æ’å…¥æ¨¡å¼æˆ–æœ«è¡Œæ¨¡å¼è¿›å…¥å‘½ä»¤æ¨¡å¼</p>
<p>ç§»åŠ¨å…‰æ ‡ï¼š</p>
<p>h: å·¦ç§» </p>
<p>j: ä¸‹ç§» </p>
<p>k: ä¸Šç§» </p>
<p>l: å³ç§»</p>
<p>M: å…‰æ ‡ç§»åŠ¨åˆ°ä¸­é—´è¡Œ </p>
<p>L: å…‰æ ‡ç§»åŠ¨åˆ°å±å¹•æœ€åä¸€è¡Œè¡Œé¦– </p>
<p>G: ç§»åŠ¨åˆ°æŒ‡å®šè¡Œ,è¡Œå· -G</p>
<p>w: å‘åä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ªå­— </p>
<p>b: å‘å‰ä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ªå­—</p>
<p>{: æŒ‰æ®µç§»åŠ¨,ä¸Šç§» </p>
<p>}: æŒ‰æ®µç§»åŠ¨,ä¸‹ç§»</p>
<p>Ctr-d: å‘ä¸‹ç¿»åŠå± </p>
<p>Ctr-u: å‘ä¸Šç¿»åŠå±</p>
<p>Ctr-f: å‘ä¸‹ç¿»ä¸€å± </p>
<p>Ctr-b: å‘ä¸Šç¿»ä¸€å±</p>
<p>gg: å…‰æ ‡ç§»åŠ¨æ–‡ä»¶å¼€å¤´ </p>
<p>G: å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾<br>åˆ é™¤å‘½ä»¤ï¼š</p>
<p>x: åˆ é™¤å…‰æ ‡åä¸€ä¸ªå­—ç¬¦,ç›¸å½“äº Del </p>
<p>X: åˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦,ç›¸å½“äº Backspace</p>
<p>dd: åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œ,n dd åˆ é™¤æŒ‡å®šçš„è¡Œæ•° D: åˆ é™¤å…‰æ ‡åæœ¬è¡Œæ‰€æœ‰å†…å®¹,åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦ </p>
<p>d0: åˆ é™¤å…‰æ ‡å‰æœ¬è¡Œæ‰€æœ‰å†…å®¹,ä¸åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦</p>
<p>dw: åˆ é™¤å…‰æ ‡å¼€å§‹ä½ç½®çš„å­—,åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦<br>æ’¤é”€å‘½ä»¤</p>
<p>u: ä¸€æ­¥ä¸€æ­¥æ’¤é”€ </p>
<p>Ctr-r: åæ’¤é”€<br>é‡å¤å‘½ä»¤ï¼š</p>
<p>.: é‡å¤ä¸Šä¸€æ¬¡æ“ä½œçš„å‘½ä»¤<br>æ–‡æœ¬è¡Œç§»åŠ¨ï¼š</p>
<blockquote>
<blockquote>
<p>: æ–‡æœ¬è¡Œå³ç§» </p>
</blockquote>
</blockquote>
<p>&lt;&lt;: æ–‡æœ¬è¡Œå·¦ç§»<br>å¤åˆ¶ç²˜è´´ï¼š</p>
<p>yy: å¤åˆ¶å½“å‰è¡Œ,n yy å¤åˆ¶ n è¡Œ </p>
<p>p: åœ¨å…‰æ ‡æ‰€åœ¨ä½ç½®å‘ä¸‹æ–°å¼€è¾Ÿä¸€è¡Œ,ç²˜è´´<br>å¯è§†æ¨¡å¼ï¼š</p>
<p>v: æŒ‰å­—ç¬¦ç§»åŠ¨,é€‰ä¸­æ–‡æœ¬ </p>
<p>V: æŒ‰è¡Œç§»åŠ¨,é€‰ä¸­æ–‡æœ¬å¯è§†æ¨¡å¼å¯ä»¥é…åˆ d, y, &gt;&gt;, &lt;&lt; å®ç°å¯¹æ–‡æœ¬å—çš„åˆ é™¤,å¤åˆ¶,å·¦å³ç§»åŠ¨<br>æ›¿æ¢æ“ä½œï¼š</p>
<p>r: æ›¿æ¢å½“å‰å­—ç¬¦ </p>
<p>R: æ›¿æ¢å½“å‰è¡Œå…‰æ ‡åçš„å­—ç¬¦<br>æŸ¥æ‰¾å‘½ä»¤ï¼š</p>
<p>/: stræŸ¥æ‰¾<br>n: ä¸‹ä¸€ä¸ª<br>Nï¼šä¸Šä¸€ä¸ª<br>æ›¿æ¢å‘½ä»¤ï¼š</p>
<p>æŠŠabcå…¨éƒ¨æ¢æˆ123</p>
<p>æœ«è¡Œæ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡æ‰€åœ¨è¡Œçš„abcæ›¿æ¢æˆ123<br>:%s/abc/123/g</p>
<p>æœ«è¡Œæ¨¡å¼ä¸‹ï¼Œå°†ç¬¬ä¸€è¡Œè‡³ç¬¬10è¡Œä¹‹é—´çš„abcæ›¿æ¢æˆ123<br>:1, 10s/abc/123/g<br>vimé‡Œæ‰§è¡Œshellä¸‹å‘½ä»¤ï¼š</p>
<p>æœ«è¡Œæ¨¡å¼é‡Œè¾“å…¥ï¼ï¼Œåé¢è·Ÿå‘½ä»¤</p>
<blockquote>
<p><a href="https://segmentfault.com/a/1190000014826120" target="_blank" rel="noopener">linuxä¸‹å®‰è£…node npmå¹¶é…ç½®</a><br><a href="https://www.jianshu.com/p/abbe619070d6" target="_blank" rel="noopener">æºç åŒ…</a><br><a href="https://segmentfault.com/a/1190000011844958" target="_blank" rel="noopener">vscodeçš„sftpæ’ä»¶</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/21/vdom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/21/vdom/" itemprop="url">
                  å…¥é—¨ç†è§£è™šæ‹ŸDOMä»¥åŠdiffç®—æ³•çš„æ ¸å¿ƒ
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-21T10:44:27+08:00">
                2019-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/02/21/vdom/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/02/21/vdom/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><ul>
<li>vdomå°±æ˜¯ç”¨jsè™šæ‹ŸçœŸå®çš„domï¼Œä»¥æ­¤å°½é‡å‡å°‘ä¸å¿…è¦çš„domæ“ä½œï¼Œæé«˜æ•ˆç‡</li>
<li>ç”¨åº“ä½¿ç”¨vdomï¼Œæ‹¿snabbdomåº“ä¸¾ä¾‹è¯´ï¼Œæ ¸å¿ƒapiæ˜¯hå’Œpatchï¼Œ<code>h(&#39;div#container.two.classes&#39;, {on: {click: someFn}},[h(&#39;span&#39;, {style: {fontWeight: &#39;bold&#39;}}, &#39;This is bold&#39;)])</code>å’Œ<code>patch(container,vnode)</code></li>
<li>diffç®—æ³•å°±æ˜¯vdomæ‰¾åˆ°éœ€è¦æ›´æ–°èŠ‚ç‚¹çš„è¿‡ç¨‹</li>
</ul>
<h2 id="åºŸè¯"><a href="#åºŸè¯" class="headerlink" title="åºŸè¯"></a>åºŸè¯</h2><p>å¼€å§‹æ¥è§¦è™šæ‹Ÿdomçš„æ—¶å€™ï¼Œè§‰å¾—ï¼Œæˆ‘[ç•¥]ï¼Œä»€ä¹ˆç©æ„ï¼Œå¾ˆå¤©ä¹¦å•Šï¼Œ=ã€‚=<br>å…¶å®çœŸæ­£æ¥è§¦çš„æ—¶å€™ï¼Œå“¦ï¼Œé©¬é©¬è™è™ï¼Œè¿˜èƒ½æ¥å—å§ï¼Œåæ­£æˆ‘åªæ˜¯ç®€å•ç†è§£æ ¸å¿ƒæ¦‚å¿µï¼Œå“ˆå“ˆå“ˆï¼Œæºç ä¾æ—§æ˜¯å¤©ä¹¦~<br>å—¯å‘ï¼Œè¿™è¾¹ï¼Œæˆ‘ä¹Ÿæ˜¯è¯´ä¸‹æ ¸å¿ƒçš„ä¸€äº›æ¦‚å¿µå§ï¼Œä¸è¿½ç©¶ç»†èŠ‚å“ˆï¼Œä¸»è¦æ˜¯ä¸ºï¼ˆwoï¼‰ä½ (ye)ä»¬(bu)èŠ‚(qing)çœ(chu)æ—¶(xi)é—´(jie)~<br>æ­¤æ–‡ä¹Ÿæ˜¯æˆ‘æ¥è§¦ä¸æ·±çš„æƒ…å†µä¸‹å†™çš„ï¼Œä»…ä»…ä¸ºäº†ä¿ƒè¿›å…¥é—¨~  </p>
<h2 id="vdomæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šå­˜åœ¨vdom"><a href="#vdomæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šå­˜åœ¨vdom" class="headerlink" title="vdomæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šå­˜åœ¨vdom"></a>vdomæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šå­˜åœ¨vdom</h2><p>doméƒ½çŸ¥é“æ˜¯å•¥å“ˆï¼Œè™šæ‹Ÿdomå­—é¢ç†è§£é‚£å°±æ˜¯è™šçš„å˜›ï¼Œè‹±æ–‡virtual domï¼Œç®€ç§°vdomï¼Œå—¯ï¼Œå®šä¹‰ä»‹ç»å®Œäº†~  </p>
<p>ä½ è¯´å¥½å¥½çš„domï¼Œå¹²å˜›å¼„ä¸ªè™šæ‹Ÿçš„ï¼Œä¸»è¦æ˜¯å› ä¸ºçœŸå®çš„domèŠ‚ç‚¹å±æ€§å¾ˆå¤šï¼Œè€Œä¸”domæ“ä½œå¾ˆæ˜‚è´µï¼ˆå°±æ˜¯è€—æ€§èƒ½ï¼‰ï¼Œæ‰€ä»¥ä¸€èˆ¬å°½é‡èƒ½å‡å°‘domæ“ä½œå°±å‡å°‘ï¼Œäºæ˜¯ç”¨jsæ¨¡æ‹ŸçœŸå®domï¼Œæ‰¾å‡ºçœŸæ­£éœ€è¦æ“ä½œçš„éƒ¨åˆ†ç„¶åå†è¿›è¡Œæ“ä½œæ¯”è¾ƒé«˜æ•ˆã€‚  </p>
<p>vdomæ¯”è¾ƒç‹¬ç«‹å“ˆï¼Œç‹¬ç«‹åˆ°å®ƒè‡ªå·±å°±æ˜¯ä¸€ä¸ªåº“ï¼Œç”¨å®ƒå°±æ˜¯æ¨¡æ‹ŸçœŸå®domï¼Œå‡å°‘ä¸å¿…è¦çš„domæ“ä½œçš„ï¼Œåé¢ä¼šä»‹ç»æ€ä¹ˆä½¿ç”¨~  </p>
<p>ä¸¾ä¸ªä¾‹å­ç†è§£å“ˆ~  </p>
<p>æœ‰ä¸‰å­¦ç”Ÿï¼Œæœ‰åæœ‰åˆ†æ•°ï¼Œç»™ä½ æ•°æ®ï¼Œä½ ç”»å‡ºä¸ªè¡¨æ ¼ï¼Œç„¶åæ•°æ®å˜åŒ–äº†ï¼Œäºæ˜¯è¡¨æ ¼ä¹Ÿè¦é‡æ–°å˜åŒ–ã€‚<br>è¿™é‡Œå°±æœ‰é—¨é“äº†ï¼Œæ•°æ®å˜åŒ–ï¼Œä½ å¯èƒ½æŠŠåŸè¡¨æ ¼åˆ é™¤é‡æ–°åšä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥çœ‹æ˜¯å“ªäº›æ•°æ®å˜åŒ–äº†ï¼Œå†ä¿®æ”¹ç‰¹å®šæ•°æ®ï¼Œä½ è¯´å“ªç§æ•ˆç‡é«˜~</p>
<h2 id="vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ"><a href="#vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ" class="headerlink" title="vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ"></a>vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ</h2><p>çŸ¥é“å®šä¹‰äº†ï¼ŒçŸ¥é“å¥½å¤„äº†ï¼Œå’‹ç”¨å‘¢ã€‚ç”¨åº“å•Šï¼Œå“ˆå“ˆå“ˆï¼Œåº“æœ‰å¾ˆå¤šï¼Œæˆ‘ä»‹(zhi)ç»(zhidao)ä¸€ä¸ªæœ‰åæ°”çš„ä¸æ˜¯æˆ‘å†™çš„åº“<a href="https://github.com/snabbdom/snabbdom" target="_blank" rel="noopener">snabbdom</a>ï¼Œæ­¤åº“æ ¸å¿ƒapiï¼Œhå’Œpatchã€‚hå°±æ˜¯è™šæ‹Ÿdomï¼Œpatchå¯ä»¥ç®€å•ç†è§£ä¸ºæ‰¾åˆ°æ–°æ—§èŠ‚ç‚¹çš„å·®åˆ«ï¼Œç„¶åæœ‰ç›®æ ‡çš„æ›´æ¢å·®åˆ«ã€‚  </p>
<p>ä¸€æ­¥æ­¥è¯´~  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- htmlçœŸå®çš„domç»“æ„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>item1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>item2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jsçš„ç›—ç‰ˆdomï¼Œå¸®åŠ©ç†è§£çš„</span></span><br><span class="line"><span class="keyword">var</span> vnode_i = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;<span class="attr">id</span>:<span class="string">'list'</span>&#125;,</span><br><span class="line">    children:[&#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,</span><br><span class="line">        chidren:<span class="string">'item1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,</span><br><span class="line">        chidren:<span class="string">'item1'</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç”¨h,å…¶å®è¿™æ ·çœ‹ç”¨æ³•å¾ˆæ˜æ˜¾ï¼Œh(å…ƒç´ ï¼Œå±æ€§ï¼Œå­å…ƒç´ )ï¼Œå­å…ƒç´ å¯èƒ½æ˜¯æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> vnode = h(<span class="string">'ul#list'</span>,&#123;&#125;,[h(&#123;<span class="attr">tag</span>:<span class="string">'li.item'</span>,&#123;&#125;,<span class="string">'item1'</span>&#125;),h(&#123;<span class="attr">tag</span>:<span class="string">'li.item'</span>,&#123;&#125;,<span class="string">'item2'</span>&#125;)])</span><br><span class="line"><span class="keyword">var</span> container = <span class="built_in">document</span>.querySelector(<span class="string">'#box'</span>)</span><br><span class="line"><span class="comment">// ç”¨patché¦–ä¸ªå‚æ•°æ˜¯çœŸå®dom,ç›¸å½“äºå¡«å……</span></span><br><span class="line">patch(container,vnode)</span><br><span class="line"><span class="keyword">var</span> newVnode = h(<span class="string">'ul#list'</span>,&#123;&#125;,[h(&#123;<span class="attr">tag</span>:<span class="string">'li.item'</span>,&#123;&#125;,<span class="string">'item1 1111'</span>&#125;),h(&#123;<span class="attr">tag</span>:<span class="string">'li.item'</span>,&#123;&#125;,<span class="string">'item2 2222'</span>&#125;)])</span><br><span class="line"><span class="comment">// ç”¨patché¦–ä¸ªå‚æ•°æ˜¯vnode,ç›¸å½“äºå°†åé¢ä¸€ä¸ªæ›¿æ¢æ‰å‰é¢çš„</span></span><br><span class="line">patch(vnode,newVnode)</span><br></pre></td></tr></table></figure>
<p><a href="https://codepen.io/frontzhm/pen/ZwZgQJ?editors=1000#0" target="_blank" rel="noopener">snabbdomä½¿ç”¨çš„demo</a>  </p>
<h2 id="diffç®—æ³•åˆæ˜¯å•¥"><a href="#diffç®—æ³•åˆæ˜¯å•¥" class="headerlink" title="diffç®—æ³•åˆæ˜¯å•¥"></a>diffç®—æ³•åˆæ˜¯å•¥</h2><p>å…¶å®è¯´åˆ°vdomï¼Œä¸å¯é¿å…è¦æåˆ°diffç®—æ³•ï¼Œï¼ï¼ï¼ï¼ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ï¼Œè¿™åˆæ˜¯ä»€ä¹ˆé¬¼ï¼Œsnabbdomåˆšåˆšæ‰å‹‰å¼ºç”¨=ã€‚=<br>å“ˆå“ˆå“ˆï¼Œæ²¡æœ‰é‚£ä¹ˆå¤¸å¼ å•¦ï¼Œä¸Šé¢ä¹Ÿæåˆ°ï¼Œvdomå°±æ˜¯æ‰¾å‡ºåŒºåˆ«ï¼Œæ¥æœ‰ç›®æ ‡çš„è¿›è¡Œæ“ä½œdomï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰¾å‡ºåŒºåˆ«å°±æ˜¯diffç®—æ³•å•¦<br>diffç®—æ³•å†å²å¾ˆæ‚ ä¹…çš„å•¦ï¼Œä½ æƒ³æƒ³ï¼Œå°±æ˜¯æ‰¾åŒºåˆ«ï¼Œæœ‰ç‚¹åƒä»¥å‰ç©çš„æ‰¾ä¸åŒæ¸¸æˆï¼Œlinuxçš„å‘½ä»¤æœ‰<code>diff aæ–‡ä»¶ bæ–‡ä»¶</code>æ¥æ‰¾å‡ºä¸¤æ–‡ä»¶çš„åŒºåˆ«ï¼Œgitä¹Ÿæœ‰è¿™ç§ï¼Œè¯´ä¸å®šä½ ä¹Ÿç”¨è¿‡<code>git diff aæ–‡ä»¶</code>ï¼Œç„¶åå°±ä¼šåˆ—å‡ºè¿™æ–‡ä»¶ä½ æ”¹å‰å’Œæ”¹åçš„åŒºåˆ«ï¼Œ<a href="http://tool.oschina.net/diff" target="_blank" rel="noopener">diffç®—æ³•åœ¨çº¿å·¥å…·</a>ä¹Ÿå¯ä»¥ç©ç©ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰ï¼Œè¿™æ ·diffç®—æ³•äº²å’Œäº†å¾ˆå¤š~<br>å½“ç„¶ï¼Œsnabbdomçš„diffç®—æ³•ï¼Œç‰¹æŒ‡æ‰¾å‡ºéœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ï¼Œå®ç°å¾ˆå¤æ‚ï¼Œè¿™è¾¹å•çº¯çš„ç®€å•è¯´ä¸‹æ ¸å¿ƒçš„ä¸€äº›ä¸œè¥¿ã€‚<br>ä¸¤ä¸ªæ–¹é¢ï¼š<code>patch(container,vnode)</code>å’Œ<code>patch(vnode,newVnode)</code>,å³è™šæ‹Ÿdomå¦‚ä½•å˜æˆçœŸå®çš„domï¼Œç„¶åæ’å…¥åˆ°ç‰¹å®šçš„containeré‡Œå’ŒèŠ‚ç‚¹æ€ä¹ˆæ›´æ–°~  </p>
<h3 id="è™šæ‹Ÿdomå¦‚ä½•å˜æˆçœŸå®çš„dom"><a href="#è™šæ‹Ÿdomå¦‚ä½•å˜æˆçœŸå®çš„dom" class="headerlink" title="è™šæ‹Ÿdomå¦‚ä½•å˜æˆçœŸå®çš„dom"></a>è™šæ‹Ÿdomå¦‚ä½•å˜æˆçœŸå®çš„dom</h3><p>å†çœ‹ä¸‹ï¼Œè™šæ‹Ÿdomæ€ä¹ˆå†™çš„ï¼Œæ³¨æ„è¿™è¾¹å¼ºè°ƒçš„æ˜¯å®ç°çš„é€»è¾‘ï¼Œæ˜¯é€»è¾‘ä»£ç ï¼Œä»…ä»…å¸®åŠ©ç†è§£çš„~</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vnode_i = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;<span class="attr">id</span>:<span class="string">'list'</span>&#125;,</span><br><span class="line">    children:[&#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,</span><br><span class="line">        chidren:<span class="string">'item1'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,</span><br><span class="line">        chidren:<span class="string">'item2'</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">vnode</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå…ƒç´ </span></span><br><span class="line">    <span class="keyword">var</span> ele = <span class="built_in">document</span>.createElement(vnode.tag)</span><br><span class="line">    <span class="keyword">var</span> attrs = vnode.attrs || &#123;&#125;</span><br><span class="line">    <span class="comment">// childrenä¼šæœ‰å­—ç¬¦ä¸²çš„æƒ…å†µï¼Œè¿™é‡Œåªæ˜¯ç¼•ä¸‹é€»è¾‘ï¼Œä¸è¯¦ç»†å±•å¼€æè¿°</span></span><br><span class="line">    <span class="keyword">var</span> children = vnode.children || []</span><br><span class="line">    <span class="comment">// å°†å…ƒç´ å±æ€§ä¸€ä¸ªä¸ªæŒ‚è½½ä¸Šå»</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> attrs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(attrs.hasOwnProperty(key))&#123;</span><br><span class="line">            ele[key] = attrs[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å°†å…ƒç´ çš„å­å…ƒç´ å†æ·»åŠ è¿›å»</span></span><br><span class="line">    children.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">child</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œçš„childä»ç„¶æ˜¯è™šæ‹ŸèŠ‚ç‚¹ï¼Œéœ€è¦å˜æˆçœŸå®èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">var</span> childNode = createElement(child)</span><br><span class="line">        <span class="comment">// å› ä¸ºåªæœ‰çœŸå®èŠ‚ç‚¹æ‰èƒ½æ·»åŠ å“‡~</span></span><br><span class="line">        ele.appendChild(childNode)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> ele</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœŸå®çš„domå†™å‡ºæ¥ä¹‹åï¼Œæ’å…¥åˆ°ç‰¹å®šcontaineré‡Œè¿™ä¸ªå¤§å®¶éƒ½çŸ¥é“çš„å“ˆ~</p>
<h3 id="èŠ‚ç‚¹æ€ä¹ˆæ›´æ–°"><a href="#èŠ‚ç‚¹æ€ä¹ˆæ›´æ–°" class="headerlink" title="èŠ‚ç‚¹æ€ä¹ˆæ›´æ–°"></a>èŠ‚ç‚¹æ€ä¹ˆæ›´æ–°</h3><p>å½“èŠ‚ç‚¹å·²ç»å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ­¤æ—¶è¯¥èŠ‚ç‚¹å‘ç”Ÿä¸€äº›å˜åŒ–ï¼Œæ€ä¹ˆå°†åŸèŠ‚ç‚¹æ›¿æ¢æ‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vnode_new = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;<span class="attr">id</span>:<span class="string">'list'</span>&#125;,</span><br><span class="line">    children:[&#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,]</span><br><span class="line">        <span class="comment">// è¿™é‡Œå‘ç”Ÿäº†å˜åŒ–</span></span><br><span class="line">        chidren:<span class="string">'item1 1111'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        tag:<span class="string">'li'</span>,</span><br><span class="line">        attrs:&#123;<span class="attr">classname</span>:<span class="string">'item'</span>&#125;,</span><br><span class="line">        chidren:<span class="string">'item2'</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateChildren</span>(<span class="params">vnode,newVnode</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// è¿™è¾¹æš‚æ—¶åªè€ƒè™‘childrenä¸åŒçš„æƒ…å†µï¼Œä¸è€ƒè™‘tagå’Œattrs</span></span><br><span class="line">    <span class="keyword">var</span> children = vnode.children || []</span><br><span class="line">    <span class="keyword">var</span> newChildren = newVnode.children || []</span><br><span class="line">    <span class="comment">// å°†å­å…ƒç´ ä¸€ä¸ªä¸ªæ¯”è¾ƒ</span></span><br><span class="line">    children.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">child,index</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// æ¯”è¾ƒçš„å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">var</span> newChild = child[index]</span><br><span class="line">        <span class="keyword">if</span>(child.tag === newChild.tag)&#123;</span><br><span class="line">            <span class="comment">// æ ‡ç­¾ç›¸åŒï¼Œatträ¸è€ƒè™‘çš„è¯ï¼Œå°±ç›¸å½“äºå†æ¬¡æ¯”è¾ƒchildçš„childrenå’ŒnewChildçš„children</span></span><br><span class="line">            updateChildren(child,newChild)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// æ ‡ç­¾ä¸åŒçš„è¯ï¼Œç›´æ¥æ›¿æ¢æ‰åŸæ¥childçš„çœŸå®èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">var</span> newChildNode = createElement(newChild)</span><br><span class="line">            <span class="comment">// childNodeå·²ç»æ˜¯çœŸå®çš„domäº†ï¼Œè¿™è¾¹åªéœ€è¦è·å–</span></span><br><span class="line">            <span class="keyword">var</span> childNode = vnode.elm</span><br><span class="line">            <span class="comment">// æ›¿æ¢æ‰</span></span><br><span class="line">            childNode.parentNode.replaceChild(newChildNode,childNode)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<!-- 



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = [&#123;<span class="attr">name</span>:<span class="string">'æä¸‰'</span>ï¼Œage:<span class="number">23</span>,<span class="attr">name</span>:<span class="string">'ç‹ä¸‰'</span>ï¼Œage:<span class="number">24</span>&#125;]</span><br><span class="line"><span class="comment">// è¡¨æ ¼å±•ç°æ•°æ®ï¼Œæ•°æ®å˜åŒ–è¡¨æ ¼è·Ÿç€å˜åŒ–</span></span><br><span class="line"><span class="comment">// jqueryå®ç°çš„é€»è¾‘ï¼Œdivæ”¾htmlï¼Œç„¶årender(data)ï¼Œbtn.onclick = function()&#123;æ•°æ®è®¾ç½®æ–°çš„ï¼Œé‡æ–°render(data)&#125;ï¼Œrenderå‡½æ•°å°±æ˜¯æ¸…ç©ºä»¥å‰çš„htmlç„¶åé‡æ–°å°†æ•°æ®æ”¾è¿›æ¥ï¼Œä¸€æ—¦æ•°æ®ä¿®æ”¹ï¼Œè¿™æ ·ä¿®æ”¹å¾ˆä½æ•ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å“ªä¸ªdoméœ€è¦å˜åŒ–ï¼Œç›¸åº”çš„æ”¹å˜è¿™ä¸ªèŠ‚ç‚¹å³å¯</span></span><br><span class="line"><span class="comment">// è¿™æ ·çš„ç¼ºç‚¹ï¼š</span></span><br><span class="line"><span class="comment">// çœŸå®çš„domå±æ€§è¶…çº§å¤šï¼Œdomæ“ä½œæ˜¯æ˜‚è´µçš„ï¼Œjsæ•ˆç‡è¿è¡Œé«˜</span></span><br><span class="line"><span class="comment">// å°½é‡å‡å°‘domæ“ä½œï¼Œè€Œä¸æ˜¯æ¨å€’é‡æ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// virtual dom ç”¨jsæ¨¡æ‹Ÿdomç»“æ„ï¼Œå°†domå¯¹æ¯”å±‚æ”¾åœ¨jså±‚ï¼Œæé«˜æ•ˆç‡,æ¨¡æ‹Ÿçš„domçš„å±æ€§å¾ˆç®€å•</span></span><br></pre></td></tr></table></figure>
<h2 id="vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ-1"><a href="#vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ-1" class="headerlink" title="vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ"></a>vdomå¦‚ä½•åº”ç”¨ï¼Œæ ¸å¿ƒapiæ˜¯ä»€ä¹ˆ</h2><ul>
<li>ä»‹ç»snabbdomåº“ï¼Œè‘—åå®ç°vdomçš„åº“</li>
<li>é‡åšä¹‹å‰çš„demo</li>
<li>æ ¸å¿ƒapi</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item1"</span>&gt;</span>Item1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item2"</span>&gt;</span>Item2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥ç®€å•çš„è™šæ‹Ÿ</span></span><br><span class="line"><span class="keyword">let</span> vnode = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;</span><br><span class="line">        id:<span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item1'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item1'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item2'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item2'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¼•ç”¨åº“ bootcdn  snabbdom   =&gt; snabbdom.js+snabbdom-class.js+snabbdom-props.js+snabbdom-style.js+snabbdom-eventlisteners.js+h.js</span></span><br><span class="line">let vnode2 = h(ul#list,&#123;&#125;,[h(li.item1,&#123;&#125;,'item1'),h(li.item2,&#123;&#125;,'item2')])</span><br><span class="line">patch(container,vnode2)</span><br><span class="line">let vnode2_modify = h(ul#list,&#123;&#125;,[h(li.item1,&#123;&#125;,'item1 1111'),h(li.item2,&#123;&#125;,'item2 2222')])</span><br><span class="line">patch(vnode2,vnode2_modify)</span><br></pre></td></tr></table></figure>
<h2 id="ä»‹ç»diffç®—æ³•ï¼ˆ60-70-çš„ä»£ç ï¼‰"><a href="#ä»‹ç»diffç®—æ³•ï¼ˆ60-70-çš„ä»£ç ï¼‰" class="headerlink" title="ä»‹ç»diffç®—æ³•ï¼ˆ60%-70%çš„ä»£ç ï¼‰"></a>ä»‹ç»diffç®—æ³•ï¼ˆ60%-70%çš„ä»£ç ï¼‰</h2><p>###ä»€ä¹ˆæ˜¯diffç®—æ³•</p>
<p>ä¸€ç›´å­˜åœ¨~<br>linuxåŸºæœ¬å‘½ä»¤<br>linuxçš„å‘½ä»¤<code>diff log1.txt log2.txt</code><br>gitå‘½ä»¤<code>git diff æŸæ–‡ä»¶</code><br><a href="http://tool.oschina.net/diff">diffåœ¨çº¿å¯¹æ¯”</a></p>
<p>###å»ç¹å°±ç®€</p>
<p>diffå¾ˆå¤æ‚ï¼Œå®ç°éš¾åº¦å¤§ï¼Œæºç é‡å¾ˆå¤§<br>å»ç¹å°±ç®€ï¼Œè®²æ˜ç™½æ ¸å¿ƒæµç¨‹ï¼Œä¸å…³æ³¨ç»†èŠ‚ï¼ˆ28åŸåˆ™ 20%çš„åŠŸèƒ½æ»¡è¶³80%çš„éœ€æ±‚ï¼Œè¿™ä¹Ÿæ˜¯çœ‹å…¶ä»–åº“çš„åŸåˆ™ï¼Œä¸èƒ½ä¸€è¡Œè¡Œçœ‹ï¼‰<br>é¢è¯•å®˜ä¹Ÿä¸æ¸…æ¥šç»†èŠ‚ï¼Œä½†å…³æ³¨æ ¸å¿ƒæµç¨‹</p>
<p>###vdomä¸ºä»€ä¹ˆç”¨diffç®—æ³•</p>
<p>domæ“ä½œæ˜¯æ˜‚è´µçš„ã€å°½é‡å‡å°‘DOMæ“ä½œ<br>æ‰¾å‡ºå¿…é¡»æ›´æ–°çš„èŠ‚ç‚¹ï¼Œå…¶ä»–çš„ä¸æ›´æ–°<br>è¿™ä¸ªæ‰¾å‡ºçš„è¿‡ç¨‹ï¼Œå°±æ˜¯diffç®—æ³•</p>
<p>vdomåº”ç”¨diffç®—æ³•å°±æ˜¯ä¸ºäº†æ‰¾å‡ºéœ€è¦æ›´æ–°çš„èŠ‚ç‚¹</p>
<p>###diffç®—æ³•çš„å®ç°æµç¨‹</p>
<p>æ ¸å¿ƒç®—æ³•createElement updateChildren</p>
<p>####patch(container,vnode)</p>
<p>å®ç°vnodeå˜æˆçœŸå®dom<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥ç®€å•çš„è™šæ‹Ÿ</span></span><br><span class="line"><span class="keyword">let</span> vnode = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;</span><br><span class="line">        id:<span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item1'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item1'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item2'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item2'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®©vnodeå˜æˆçœŸå®dom</span></span><br><span class="line"><span class="comment">// ...createElement(vnode)</span></span><br></pre></td></tr></table></figure></p>
<h4 id="patch-vnode-newVnode"><a href="#patch-vnode-newVnode" class="headerlink" title="patch(vnode,newVnode)"></a>patch(vnode,newVnode)</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯ä»¥ç®€å•çš„è™šæ‹Ÿ</span></span><br><span class="line"><span class="keyword">let</span> vnode = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;</span><br><span class="line">        id:<span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item1'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item2'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> vnode2 = &#123;</span><br><span class="line">    tag:<span class="string">'ul'</span>,</span><br><span class="line">    attrs:&#123;</span><br><span class="line">        id:<span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children:[</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item1'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item2222'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item222'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        &#123;</span><br><span class="line">            tag:<span class="string">'li'</span>,</span><br><span class="line">            attrs:&#123;</span><br><span class="line">                classname:<span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children:[<span class="string">'Item3'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¯”è¾ƒæ–°æ—§åŒºåˆ«</span></span><br><span class="line"><span class="comment">// function updateChildren(vnode,newVnode)</span></span><br></pre></td></tr></table></figure>
<p>èŠ‚ç‚¹æ–°å¢å’Œåˆ é™¤<br>èŠ‚ç‚¹é‡æ–°æ’åº<br>èŠ‚ç‚¹å±æ€§ æ ·å¼ äº‹ä»¶ç»‘å®š<br>å¦‚ä½•æè‡´å‹æ¦¨æ€§èƒ½</p>
<p><code>`</code></p>
<p> â€“&gt;</p>
-->
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/15/1_async_history/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/02/15/1_async_history/" itemprop="url">
                  å¼‚æ­¥çš„å‘å±•ï¼Œé¡ºæ‰‹å­¦ä¼šæ€ä¹ˆå¤„ç†å¹¶å‘è¯·æ±‚
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-02-15T11:31:58+08:00">
                2019-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/02/15/1_async_history/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/02/15/1_async_history/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><ul>
<li>å¼‚æ­¥ï¼šå…ˆå¹²ä¸€ä»¶äº‹ï¼Œä¸­é—´å»å¹²å…¶ä»–çš„äº‹ï¼Œæœ€ç»ˆå†å›æ¥å¹²è¿™ä»¶äº‹</li>
<li>é«˜é˜¶å‡½æ•°æ˜¯å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…å‡½æ•°ä½œä¸ºè¿”å›å€¼ ï¼Œä½œç”¨æ˜¯æ‰¹é‡ç”Ÿæˆå‡½æ•°å’Œé¢„ç½®å‡½æ•°åšä¸ºå‚æ•°ï¼ˆå¯ä»¥ç¼“å­˜å‡½æ•°ï¼Œå½“è¾¾åˆ°æ¡ä»¶æ—¶æ‰§è¡Œè¯¥å‡½æ•°ï¼‰</li>
<li>å¼‚æ­¥çš„å‘å±•æµç¨‹ï¼šcallback -&gt;  promise -&gt; generator + co -&gt; async+await(è¯­æ³•ç³–)</li>
<li>å›è°ƒå‡½æ•°é‡‘å­—å¡”å¤„ç†å¤šè¯·æ±‚ -&gt; å“¨å…µå‡½æ•°å¤„ç†å¤šè¯·æ±‚ -&gt; promiseå¤„ç†å¤šè¯·æ±‚ -&gt; coå¤„ç†å¤šè¯·æ±‚ -&gt; asyncå¤„ç†å¤šè¯·æ±‚</li>
<li>æ‰‹å†™å®ç°coã€bluebirdçš„promisifyå’ŒpromisifyAll</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/02/15/1_async_history/#more" rel="contents">
              é˜…è¯»å…¨æ–‡ &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/06/cnzz/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/06/cnzz/" itemprop="url">
                  ç½‘ç«™åŠ cnzz
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-09-06T09:58:54+08:00">
                2018-09-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
                  ï¼Œ 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/ç»Ÿè®¡/" itemprop="url" rel="index">
                    <span itemprop="name">ç»Ÿè®¡</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/09/06/cnzz/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/06/cnzz/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="cnzz"><a href="#cnzz" class="headerlink" title="cnzz"></a>cnzz</h1><p>cnzzå°±æ˜¯ç»Ÿè®¡æ•°æ®ç”¨çš„ï¼Œç»Ÿè®¡pvï¼Œuvï¼Œç”šè‡³æŸä¸ªæŒ‰é’®çš„ç‚¹å‡»æ¬¡æ•°ã€‚</p>
<h2 id="ç½‘ç«™çš„æ·»åŠ æ­¥éª¤"><a href="#ç½‘ç«™çš„æ·»åŠ æ­¥éª¤" class="headerlink" title="ç½‘ç«™çš„æ·»åŠ æ­¥éª¤"></a>ç½‘ç«™çš„æ·»åŠ æ­¥éª¤</h2><ol>
<li><a href="https://web.umeng.com" target="_blank" rel="noopener">å»ç½‘ç«™æ³¨å†Œè´¦å·</a>ï¼Œç„¶åæ·»åŠ ç½‘ç«™</li>
<li>è·å–ä»£ç ï¼Œåœ¨bodyå‰æ·»åŠ è„šæœ¬ï¼Œæ³¨æ„ä¸€ä¸ªåŸŸåå¯¹åº”ä¸€ä¸ªidï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåŸŸåå¯¹åº”ä¸€ä¸ªè„šæœ¬</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//s22.cnzz.com/z_stat.php?id=ä½ çš„id&amp;web_id=ä½ çš„id"</span> <span class="attr">language</span>=<span class="string">"JavaScript"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol>
<li>ç½‘ç«™ä¸Šä¼šæ˜¾ç¤ºç«™é•¿ç»Ÿè®¡å››ä¸ªå­—æˆ–è€…å›¾æ ‡ï¼Œå«Œä¸å¥½çœ‹çš„è¯,æˆ‘ç”¨çš„æ˜¯å­—</li>
</ol>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span><span class="selector-attr">[title=ç«™é•¿ç»Ÿè®¡]</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="äº‹ä»¶çš„ç»Ÿè®¡"><a href="#äº‹ä»¶çš„ç»Ÿè®¡" class="headerlink" title="äº‹ä»¶çš„ç»Ÿè®¡"></a>äº‹ä»¶çš„ç»Ÿè®¡</h2><ol>
<li><p><a href="http://open.cnzz.com/a/new/trackevent/" target="_blank" rel="noopener">æŸä¸ªæŒ‰é’®çš„ç‚¹å‡»æ¬¡æ•°ç»Ÿè®¡çš„è¯</a>ï¼Œå…ˆä¸Šé¢çš„æ­¥éª¤ï¼Œç„¶å</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å¾—æ·»åŠ id</span></span><br><span class="line">someElement.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    _czc.push([<span class="string">'_trackEvent'</span>, <span class="string">'ä»Šæ—¥å¤´æ¡é‡Œç‚¹å‡»ä¸‹è½½appæ¬¡æ•°'</span>, <span class="string">'ä¸‹è½½'</span>, <span class="string">'app'</span>,<span class="string">'5'</span>,<span class="string">'wx-share'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> å…·ä½“ä»‹ç»:<br> å„å‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š<br> categoryï¼šäº‹ä»¶ç±»åˆ«ï¼Œå¿…å¡«é¡¹ï¼Œè¡¨ç¤ºäº‹ä»¶å‘ç”Ÿåœ¨è°èº«ä¸Šï¼Œå¦‚â€œè§†é¢‘â€ã€â€œå°è¯´â€ã€â€œè½®æ˜¾å±‚â€ç­‰ç­‰ã€‚<br> actionï¼šäº‹ä»¶æ“ä½œï¼Œå¿…å¡«é¡¹ï¼Œè¡¨ç¤ºè®¿å®¢è·Ÿå…ƒç´ äº¤äº’çš„è¡Œä¸ºåŠ¨ä½œï¼Œå¦‚â€æ’­æ”¾â€ã€â€æ”¶è—â€ã€â€ç¿»å±‚â€ç­‰ç­‰ã€‚<br> labelï¼šäº‹ä»¶æ ‡ç­¾ï¼Œé€‰å¡«é¡¹ï¼Œç”¨äºæ›´è¯¦ç»†çš„æè¿°äº‹ä»¶ï¼Œä»å„ä¸ªæ–¹é¢éƒ½å¯ä»¥ï¼Œæ¯”å¦‚å…·ä½“æ˜¯å“ªä¸ªè§†é¢‘ï¼Œå“ªéƒ¨å°è¯´ï¼Œç¿»åˆ°äº†ç¬¬å‡ å±‚ç­‰ç­‰ã€‚<br> valueï¼šäº‹ä»¶å€¼ï¼Œé€‰å¡«é¡¹ï¼Œæ•´æ•°å‹ï¼Œç”¨äºå¡«å†™æ‰“åˆ†å‹äº‹ä»¶çš„åˆ†å€¼ï¼ŒåŠ è½½æ—¶é—´å‹äº‹ä»¶çš„æ—¶é•¿ï¼Œè®¢å•å‹äº‹ä»¶çš„ä»·æ ¼ç­‰ç­‰ã€‚<br> nodeidï¼šdivå…ƒç´ idï¼Œé€‰å¡«é¡¹ï¼Œå¡«å†™ç½‘é¡µä¸­çš„divå…ƒç´ idå€¼ï¼Œç”¨äºåœ¨â€œç”¨æˆ·è§†ç‚¹â€åŠŸèƒ½ä¸Šé‡ç»˜å…ƒç´ çš„äº‹ä»¶å‘ç”Ÿæƒ…å†µã€‚<br> æŸ¥çœ‹APIè¯¦ç»†è¯´æ˜</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_czc.push([<span class="string">"_trackEvent"</span>,category,action,label,value,nodeid]);</span><br></pre></td></tr></table></figure>
</li>
<li><p>è®°å¾—å·¦ä¸Šè§’ä¸‹æ‹‰ç®­å¤´åˆ‡æ¢ä¸åŒåŸŸåï¼Œä»¥åŠå·¦ä¾§èœå•æ çš„å—è®¿é¡µé¢å¯ä»¥è¿›è¡Œæœç´¢ï¼Œä¹Ÿå¯ä»¥å³ä¸Šè§’ç«™ç‚¹è®¾ç½®é‡Œæ’é™¤æŸäº›é¡µé¢å’Œip</p>
</li>
</ol>
<h2 id="æ”¹è¿›çš„ä»£ç "><a href="#æ”¹è¿›çš„ä»£ç " class="headerlink" title="æ”¹è¿›çš„ä»£ç "></a>æ”¹è¿›çš„ä»£ç </h2><p>å› ä¸ºç»å¸¸åœ¨æµ‹è¯•å’Œæ­£å¼ç¯å¢ƒåˆ‡æ¢,è€Œä¸”æ¯æ¬¡åŠ cssæ ·å¼éšè—å›¾æ ‡ä¹Ÿæ˜¯ç¥çƒ¦. ç¨å¾®æ”¹è¿›ä¸€ä¸¢ä¸¢.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * cnzzæ•°æ®ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> isProduction = <span class="regexp">/æ­£å¼åŸŸå/</span>.test(<span class="built_in">window</span>.location.href)</span><br><span class="line"><span class="comment">// !!!åŸŸåå’Œè„šæœ¬idå¿…é¡»ä¸€ä¸€å¯¹åº”</span></span><br><span class="line"><span class="keyword">var</span> productionCnzzId = <span class="string">'12899668'</span></span><br><span class="line"><span class="keyword">var</span> testCnzzId = <span class="string">'126326337'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> statScript = <span class="built_in">document</span>.body.appendChild(<span class="built_in">document</span>.createElement(<span class="string">'script'</span>))</span><br><span class="line">statScript.src = isProduction ? (<span class="string">'//s22.cnzz.com/z_stat.php?id='</span>+productionCnzzId+<span class="string">'&amp;web_id='</span>+productionCnzzId) : (<span class="string">'//s22.cnzz.com/z_stat.php?id='</span>+testCnzzId+<span class="string">'&amp;web_id='</span>+testCnzzId)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ç”¨å»¶æ—¶æ˜¯å› ä¸ºcnzzè„šæœ¬æ’å…¥éœ€è¦æ—¶é—´</span></span><br><span class="line">    statScript.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// éšè—ç»Ÿè®¡å­—</span></span><br><span class="line">        <span class="built_in">document</span>.querySelector(<span class="string">'a[title="ç«™é•¿ç»Ÿè®¡"]'</span>).style.cssText = <span class="string">'position: absolute; visibility: hidden; bottom: 0; z-index: -1;'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/06/promise2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="frontzhm">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://omizt4opc.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èŠ±èŠ±çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/06/promise2/" itemprop="url">
                  promiseå†æ€»ç»“æ€»ç»“
                </a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-09-06T09:58:54+08:00">
                2018-09-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/09/06/promise2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/06/promise2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h1><p>è¯­æ³•:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h2><p>å¯¹XHPHttpRequestçš„å°è£…<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Return a new promise.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do the usual XHR stuff</span></span><br><span class="line">    <span class="keyword">var</span> req = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    req.open(<span class="string">'GET'</span>, url);</span><br><span class="line"></span><br><span class="line">    req.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// This is called even on 404 etc</span></span><br><span class="line">      <span class="comment">// so check the status</span></span><br><span class="line">      <span class="keyword">if</span> (req.status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">// Resolve the promise with the response text</span></span><br><span class="line">        resolve(req.response);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Otherwise reject with the status text</span></span><br><span class="line">        <span class="comment">// which will hopefully be a meaningful error</span></span><br><span class="line">        reject(<span class="built_in">Error</span>(req.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle network errors</span></span><br><span class="line">    req.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="built_in">Error</span>(<span class="string">"Network Error"</span>));</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make the request</span></span><br><span class="line">    req.send();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ”¹è‰¯ç‰ˆ:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fetch(url)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getJSON</span>(<span class="params">url</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> get(url).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;response.json()&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="å›è°ƒå‡½æ•°å•å‚æ•°çš„å¤„ç†"><a href="#å›è°ƒå‡½æ•°å•å‚æ•°çš„å¤„ç†" class="headerlink" title="å›è°ƒå‡½æ•°å•å‚æ•°çš„å¤„ç†"></a>å›è°ƒå‡½æ•°å•å‚æ•°çš„å¤„ç†</h2><p>æ¯”å¦‚:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">oneParam</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> data.toString()</span><br><span class="line">&#125;</span><br><span class="line">getJSON(url1).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> oneParam(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ç®€åŒ–ä¸º,æ¥ä¸‹å»çš„å€¼å°±æ˜¯oneParam(data)</span></span><br><span class="line">getJSON(url1).then(oneParam)</span><br></pre></td></tr></table></figure></p>
<h2 id="æ‰©å……ä¸‹å›è°ƒå‡½æ•°å‚æ•°ä¸ªæ•°çš„é—®é¢˜"><a href="#æ‰©å……ä¸‹å›è°ƒå‡½æ•°å‚æ•°ä¸ªæ•°çš„é—®é¢˜" class="headerlink" title="æ‰©å……ä¸‹å›è°ƒå‡½æ•°å‚æ•°ä¸ªæ•°çš„é—®é¢˜"></a>æ‰©å……ä¸‹å›è°ƒå‡½æ•°å‚æ•°ä¸ªæ•°çš„é—®é¢˜</h2><p>å…¶å®é‡åˆ°å›è°ƒå‡½æ•°æœ‰æ—¶å€™è‡ªå¸¦å‚æ•°,æœ‰æ—¶å€™ä¸å¸¦å‚æ•°,æœ‰æ—¶å€™æœ‰ä¸€ä¸ªå‚æ•°,æœ‰æ—¶å€™æœ‰å¤šä¸ªå‚æ•°</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fn()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»”ç»†çœ‹ä¸Šé¢çš„,å…¶å® <code>a(fn)</code>ç­‰ä»·äº<code>fn()</code></p>
<p>å¸¸ç”¨åœ¨æ•°ç»„é‡Œ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> item ++</span><br><span class="line">&#125;</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> log(item)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ç®€åŒ–ä¸º</span></span><br><span class="line">arr.forEach(log)</span><br><span class="line"><span class="comment">// åŒç†</span></span><br><span class="line">arr.map(log)</span><br></pre></td></tr></table></figure>
<h2 id="å¹¶å‘è¯·æ±‚çš„å¤„ç†"><a href="#å¹¶å‘è¯·æ±‚çš„å¤„ç†" class="headerlink" title="å¹¶å‘è¯·æ±‚çš„å¤„ç†"></a>å¹¶å‘è¯·æ±‚çš„å¤„ç†</h2><p>å‡è®¾story.jsonçš„å†…å®¹æ˜¯<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"heading"</span>: <span class="string">"&lt;h1&gt;A story about something&lt;/h1&gt;"</span>,</span><br><span class="line">  <span class="string">"chapterUrls"</span>: [</span><br><span class="line">    <span class="string">"chapter-1.json"</span>,</span><br><span class="line">    <span class="string">"chapter-2.json"</span>,</span><br><span class="line">    <span class="string">"chapter-3.json"</span>,</span><br><span class="line">    <span class="string">"chapter-4.json"</span>,</span><br><span class="line">    <span class="string">"chapter-5.json"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="forEachçš„å‘"><a href="#forEachçš„å‘" class="headerlink" title="forEachçš„å‘"></a>forEachçš„å‘</h3><p>é¦–å…ˆæƒ³åˆ°forEach</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getJSON(<span class="string">'story.json'</span>)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// return res.chapterUrls.forEach(url=&gt;getJSON(url).then(content=&gt;addToHtml(content)))</span></span><br><span class="line">    <span class="comment">// è¿˜è®°å¾—å•å‚æ•°çš„äº‹å§</span></span><br><span class="line">    <span class="keyword">return</span> res.chapterUrls.forEach(<span class="function"><span class="params">url</span>=&gt;</span>getJSON(url).then(addToHtml))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„å‘åœ¨äºå‘å‡ºè¯·æ±‚äº†,ä½†æ˜¯å› ä¸ºå“åº”æ—¶é—´ä¸ä¸€å®š,æ‰€ä»¥æ’å…¥çš„æ—¶å€™å¯èƒ½ç« èŠ‚2åœ¨ç« èŠ‚1å‰é¢</p>
<h3 id="ç”¨ç”¨mapå’ŒPromise-all"><a href="#ç”¨ç”¨mapå’ŒPromise-all" class="headerlink" title="ç”¨ç”¨mapå’ŒPromise.all"></a>ç”¨ç”¨mapå’ŒPromise.all</h3><p>ç»„æˆä¸€ä¸ªpromiseçš„æ•°ç»„,ç­‰åˆ°éƒ½ä¸‹è½½éƒ½å®Œæˆäº†å†æ·»åŠ åˆ°htmlä¸­.<br>Promise.allå°±æ˜¯æ‰€æœ‰promiseéƒ½å˜æˆfulfilledçŠ¶æ€äº†æ‰ç»§ç»­.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">getJSON(<span class="string">'story.json'</span>)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// return res.chapterUrls.forEach(url=&gt;getJSON(url).then(content=&gt;addToHtml(content)))</span></span><br><span class="line">    <span class="comment">// è¿˜è®°å¾—å•å‚æ•°çš„äº‹å§</span></span><br><span class="line">    <span class="comment">// return Promise.all(res.chapterUrls.map(url=&gt;getJSON(url)))</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.all(res.chapterUrls.map(getJSON))</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">resArr</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// resArr.forEach(charter=&gt;addToHtml(charter))</span></span><br><span class="line">    resArr.forEach(addToHtml)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä½†è¿™é‡Œè¿˜æœ‰ä¸ªä¸å°½å¦‚äººæ„çš„åœ°æ–¹,å°±æ˜¯è™½ç„¶å¹¶å‘è¯·æ±‚,ä½†æ˜¯ç­‰åˆ°æ‰€æœ‰è¯·æ±‚ç»“æœäº†æ‰ç»§ç»­ä¸‹ä¸€æ­¥,ç†æƒ³æƒ…å†µæ˜¯ç« èŠ‚1ç»“æœæ¥äº†ç›´æ¥æ˜¾ç¤º,ç« èŠ‚2ç»“æœæ¥äº†åªè¦ç« èŠ‚1æ¥äº†å°±å¯ä»¥æ˜¾ç¤º,ä»¥æ­¤ç±»æ¨</p>
<h3 id="ç”¨ç”¨è¿­ä»£"><a href="#ç”¨ç”¨è¿­ä»£" class="headerlink" title="ç”¨ç”¨è¿­ä»£"></a>ç”¨ç”¨è¿­ä»£</h3><p>å…ˆè¯´è¯´ç®€å•çš„è¿­ä»£<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> sum</span><br><span class="line">arr.forEach(<span class="function"><span class="params">item</span>=&gt;</span>sum+=item)</span><br><span class="line"><span class="comment">// æ¯ç»è¿‡ä¸€é¡¹å°±è¿›è¡ŒåŠ ,å˜æˆæ–°çš„sum</span></span><br><span class="line">arr.reduce(<span class="function">(<span class="params">sum,item</span>)=&gt;</span>(sum+item),sum)</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œé’ˆå¯¹è¯·æ±‚å¯ä»¥è¿™æ ·</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sequence = <span class="built_in">Promise</span>.resolve()</span><br><span class="line">getJSON(<span class="string">'story.json'</span>)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.chapterUrls.map(getJSON).then(<span class="function"><span class="keyword">function</span>(<span class="params">promiseArr</span>)</span>&#123;</span><br><span class="line">        promiseArr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">promise</span>)</span>&#123;</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€ä¸ªpromiseå˜æˆfulfilledä¹‹åå°±æ·»åŠ åˆ°html</span></span><br><span class="line">            <span class="comment">// æ­¤æ—¶sequenceå˜æˆä»¥ä¸‹,åªæœ‰thençš„çŠ¶æ€å®Œæˆäº†æ‰èƒ½ç»§ç»­ä¸‹ä¸€ä¸ªaddToHtml</span></span><br><span class="line">            sequence = sequence.then(<span class="function"><span class="keyword">function</span>(<span class="params">promise</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> promise</span><br><span class="line">            &#125;).then(addToHtml)</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç”¨reduceæ”¹å†™ä¸‹<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">getJSON(<span class="string">'story.json'</span>)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.chapterUrls.map(getJSON).then(<span class="function"><span class="keyword">function</span>(<span class="params">promiseArr</span>)</span>&#123;</span><br><span class="line">        promiseArr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">sequence,promise</span>)</span>&#123;</span><br><span class="line">            <span class="comment">// ç¬¬ä¸€ä¸ªpromiseå˜æˆfulfilledä¹‹åå°±æ·»åŠ åˆ°html</span></span><br><span class="line">            <span class="comment">// æ­¤æ—¶sequenceå˜æˆä»¥ä¸‹,åªæœ‰thençš„çŠ¶æ€å®Œæˆäº†æ‰èƒ½ç»§ç»­ä¸‹ä¸€ä¸ªaddToHtml</span></span><br><span class="line">            <span class="keyword">return</span> sequence.then(<span class="function"><span class="keyword">function</span>(<span class="params">promise</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> promise</span><br><span class="line">            &#125;).then(addToHtml)</span><br><span class="line">        &#125;,<span class="built_in">Promise</span>.resolve())</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h2 id="ä»¥ä¸Šæ¥æºäºgoogleçš„æ–‡æ¡£"><a href="#ä»¥ä¸Šæ¥æºäºgoogleçš„æ–‡æ¡£" class="headerlink" title="ä»¥ä¸Šæ¥æºäºgoogleçš„æ–‡æ¡£"></a>ä»¥ä¸Šæ¥æºäºgoogleçš„æ–‡æ¡£</h2><p>å¯ä»¥çœ‹<a href="https://developers.google.cn/web/fundamentals/primers/promises#xmlhttprequest_promise" target="_blank" rel="noopener">googleçš„æ–‡æ¡£</a>.<br><a href="https://github.com/googlesamples/web-fundamentals/tree/gh-pages/fundamentals/primers" target="_blank" rel="noopener">ä¾‹å­åœ¨github</a></p>
<p>è¯´ä¸‹å°ç™½çš„æ­¥æ­¥æ“ä½œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/googlesamples/web-fundamentals</span><br><span class="line">cd web-fundamentals</span><br><span class="line">npm install anywhere -g</span><br><span class="line">anywhere</span><br><span class="line"><span class="meta">#</span> ç‚¹å‡»å…·ä½“çš„æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†å¦‚async-best-example.html</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://omizt4opc.bkt.clouddn.com/avatar.jpg"
               alt="frontzhm" />
          <p class="site-author-name" itemprop="name">frontzhm</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">70</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">frontzhm</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"frontzhm"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  

  


  

</body>
</html>
